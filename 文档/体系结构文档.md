# 软件体系结构文档

## 文档修改历史

| 修改人员 | 日期 | 修改原因 | 版本号 |
| :------: | ---- | -------- | ------ |
|  刘佳月、沈祎辰、王雨晨、殷德林 | 2020.4.23 | 添加迭代一、二部分 | V1.0.0 |
|  王雨晨 | 2020.4.24 | 处理用户界面层分解排版问题 | V1.0.1 |
| 殷德林 | 2020.4.25 | 更改信息视角中的类型 | V1.0.2 |


## 目录

<!-- TOC -->

- [软件体系结构文档](#软件体系结构文档)
    - [文档修改历史](#文档修改历史)
    - [目录](#目录)
    - [引言](#引言)
        - [编制目的](#编制目的)
        - [参考资料](#参考资料)
    - [产品概述](#产品概述)
    - [逻辑视图](#逻辑视图)
    - [组合视图](#组合视图)
        - [开发包图](#开发包图)
        - [运行时进程](#运行时进程)
        - [物理部署](#物理部署)
    - [架构设计](#架构设计)
        - [模块职责](#模块职责)
        - [用户界面层分解](#用户界面层分解)
            - [职责](#职责)
            - [接口规范](#接口规范)
                - [userui模块](#userui模块)
                - [hotelui模块](#hotelui模块)
                - [hotelmanagerui模块](#hotelmanagerui模块)
                - [adminui模块](#adminui模块)
                - [couponui模块](#couponui模块)
                - [orderui模块](#orderui模块)
        - [业务逻辑层分解](#业务逻辑层分解)
            - [职责](#职责-1)
            - [接口规范](#接口规范-1)
        - [数据层分解](#数据层分解)
            - [职责](#职责-2)
            - [接口规范](#接口规范-2)
        - [信息视角](#信息视角)

<!-- /TOC -->

## 引言

### 编制目的

本报告详细完成对酒店预订系统的概要设计，达到指导详细设计和开发的目的，同时实现和测试人员及用户的沟通。
本报告面向开发人员、测试人员及最终用户而编写，是了解系统的导航。

### 参考资料

[1] 骆斌，丁二玉，刘钦 . 软件工程与技术（卷二）: 软件开发的技术基础 [M] . 北京: 机械工业出版社，2012
[2]IEEE标准

## 产品概述

参考酒店预订系统用例文档和软件需求规格说明中对产品的概括描述

## 逻辑视图

互联网酒店预订系统中，选择了分层体系结构风格，将系统分为3层（展示层、业务逻辑层、数据层）能够很好地示意整个高层抽象。展示层包含GUI页面的实现和用户行为的响应，业务逻辑层包含业务逻辑处理的实现，数据层负责数据的持久化和访问。分层结构的设计方案和逻辑设计方案如图所示。

<img src="https://supernatural.oss-cn-beijing.aliyuncs.com/设计方案.png" style="zoom:50%;" />

概要功能：

<img src="https://supernatural.oss-cn-beijing.aliyuncs.com/逻辑设计.png" style="zoom:50%;" />


## 组合视图

### 开发包图

|      开发包      | 依赖的其他开发包                                |
| :--------------: | ----------------------------------------------- |
|      mainui      | views, store, api, router, vo,controller        |
|     adminbl      | po, vo                                          |
|     couponbl     | po, vo                                          |
|     creditbl      | po, vo, util                                   |
|  curRoombl | po|
|     hotelbl      | po, vo, util                                    |
| messagebl | po,vo |
|     orderbl      | po, vo,util                                      |
|      userbl      | po, vo                                          |
|   adminblImpl    | po, vo, adminbl,hotelbl,hoteldata,userdata, admindata, enums,util               |
|   couponblImpl   | po, vo, couponbl,userbl, coupondata                    |
| creditblImpl | creditbl,po,vo,creditdata,orderdata,util |
| curRoomblImpl | curRoombl,curRoomdata,po |
|   hotelblImpl    | po, vo, hotelbl, userbl,couponbl,orderbl, hoteldata, util, enums |
| messageblImpl | messagebl, messagedata,userdata,po,vo,util |
|   orderblImpl    | hotelbl, orderbl, userbl, orderdata,creditbl,curRoomdata,hoteldata,userdata,po,vo             |
|    userblImpl    | userbl, userdata, po, vo,creditbl,orderdata                        |
| admincontroller  | adminbl, vo,userbl,                                     |
| couponcontroller | couponbl, vo                                    |
| creditcontroller | creditbl,creditImpl,vo |
| hotelcontroller  | hotelbl,po, vo, util                            |
|messagecontroller | messagebl,vo |
| ordercontroller  | orderbl, vo                                     |
|  usercontroller  | userbl, po, vo,oss,creditbl,enums                                  |
|    admindata     | po,util                                              |
|    coupondata    | po,util   ,annotations                                           |
| creditdata | po,util |
| curRoomdata | po,annotations |
|    hoteldata     | po ,annotations                                         |
| messagedata | po,annotations |
|    orderdata     | po,annotations,util                                              |
|     userdata     | po,annotaions,util                                             |
|        po        | enums ,Timestamp,LocalDateTime,LocalDate                                          |
|        vo        |                       util                          |
|      config      |                                                 |
|      enums       |                                                 |
|       util       |                                                 |

![](https://ydl8023.oss-cn-beijing.aliyuncs.com/包图.png)



### 运行时进程

- 表示软件在运行时进程间的交互，描述系统的动态结构。
  在酒店预订系统中，会有多个客户端进程和一个服务器进程，其进程图如下图所示。

- 示意图：
  ![](https://supernatural.oss-cn-beijing.aliyuncs.com/进程图(1).png)


### 物理部署

- 处理如何将软件组件映射到硬件基础设施。
  酒店预订系统中，tomcat和MySQL分别使用容器部署在服务器上，部署图如下。

- 示意图

  ![](https://supernatural.oss-cn-beijing.aliyuncs.com/物理部署图(2).png)



## 架构设计

- 描述功能分解和如何在不同的层中安排软件模块
  - 描述架构中的对象，包含架构图
  - 描述组件接口信息
    - 包括：语法、前置条件、后置条件

### 模块职责

- 各层职责

|     层     | 职责                                         |
| :--------: | -------------------------------------------- |
| 用户界面层 | 基于窗口的酒店预订系统的用户界面             |
| 业务逻辑层 | 对于用户界面的输入进行响应并进行业务处理逻辑 |
|   数据层   | 负责数据的持久化及数据访问接口               |

- 层之间调用接口
  每一层只是使用下方直接接触的层。层与层之间仅仅是通过接口的调用来完成的。层之间调用的接口如下表。

| 接口                                                         | 服务调用方 | 服务提供方 |
| ------------------------------------------------------------ | ---------- | ---------- |
| AdminService<br />CouponMatchStrategyService<br />CouponService<br />CreditService<br />DefaultCreditUpdateService<br />CurRoomService<br />CommentService<br />HotelService<br />RoomService<br />TagService<br />BroadCastService<br />MessageService<br />OrderService<br />AccountService | 展示层     | 业务逻辑层 |
| AdminMapper<br />CouponMapper<br />CreditMapper<br />CurRoomMapper<br />CommentMapper<br />HotelMapper<br />MyTagMapper<br />RoomMapper<br />BroadCastMapper<br />MessageMapper <br />OrderMapper<br />AccountMapper<br />MemberMapper| 业务逻辑层 | 数据层     |

借用预订用例来说明层之间的调用，如下图所示。每一层之间都是由上层依赖了一个需接口，而下层实现这个供接口。OrderService提供了预订所需要的所有业务逻辑功能，OrderMapper提供了对数据库的增删改查等操作。这样的实现就大大降低了层与层之间的耦合。

![](https://supernatural.oss-cn-beijing.aliyuncs.com/预订用例层之间调用的接口(1).png)

### 用户界面层分解

根据需求，系统存在18个用户界面：登陆界面、注册界面、客户主界面、酒店管理人员主界面、网站营销人员主界面、网站管理员主界面、个人中心界面、酒店信息界面、客户信息界面、客户订单界面、酒店房间信息界面、酒店详情界面、酒店信息管理界面、订单管理界面、添加优惠策略界面、录入可用房间界面、用户管理界面、酒店管理界面。界面跳转如图所示。

![](https://supernatural.oss-cn-beijing.aliyuncs.com/界面跳转2.png)

#### 职责

|  模块   | 职责                 |
| :-----: | -------------------- |
| userui  | 用户界面，负责展示或更新用户信息             |
| hotelui | 酒店界面，负责展示或更新酒店信息 |
| hotelManagerui | 酒店管理人员操作界面 |
| adminui | 网站管理员操作界面 |
| couponui | 展示或更新优惠策略 |
| orderui | 展示或更新订单信息 |

#### 接口规范

##### userui模块

userui模块接口规范如下：

<table>
		<td rowspan="10" style="valign='middle';"><center>userui</center></td>
    <tr>
        <td>语法</td>
        <td>getUserInfoAPI(id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要根据id获取用户信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回用户信息</td>
    </tr>
    <tr>
        <td>语法</td>
        <td>updateUserInfoAPI(data)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要更新用户信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新用户信息，并返回更新是否成功</td>
    </tr>
</table>

userui模块需要的服务接口如下：

|            服务名             |     服务     |
| :---------------------------: | :----------: |
|       AccountController.getUserInfo      |      获取用户信息      |
|       AccountController.updateInfo       |      更新用户信息      |

##### hotelui模块

hotelui模块接口规范如下：

<table>
		<td rowspan="10" style="valign='middle';"><center>hotelui</center></td>
    <tr>
        <td>语法</td>
        <td>getHotelsAPI()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取酒店信息列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回酒店信息列表</td>
    </tr>
    <tr>
        <td>语法</td>
        <td>getHotelByIdAPI(param)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取指定酒店详细信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回指定酒店详细信息</td>
    </tr>
</table>

hotelui模块需要的服务接口如下：

|            服务名             |     服务     |
| :---------------------------: | :----------: |
|      HotelController.retrieveAllHotels      |      获取酒店信息列表      |
|      HotelController.retrieveHotelDetail      |      获取酒店详细信息      |

##### hotelmanagerui模块

hotelmanagerui模块接口规范如下：

<table>
		<td rowspan="10" style="valign='middle';"><center>hotelmanagerui</center></td>
    <tr>
        <td>语法</td>
        <td>addRoomAPI(data)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要更新酒店房间信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新酒店房间信息</td>
    </tr>
    <tr>
        <td>语法</td>
        <td>addHotelAPI(data)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加酒店</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加酒店</td>
    </tr>
</table>

hotelmanagerui模块需要的服务接口如下：

|            服务名             |     服务     |
| :---------------------------: | :----------: |
|       HotelController.addRoomInfo       |       更新酒店房间信息       |
|       HotelController.addHotel       |       添加酒店       |

##### adminui模块

adminui模块接口规范如下：

<table>
		<td rowspan="10" style="valign='middle';"><center>adminui</center></td>
    <tr>
        <td>语法</td>
        <td>addManagerAPI(data)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加酒店工作人员账号</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加酒店工作人员账号，并返回添加是否成功</td>
    </tr>
    <tr>
        <td>语法</td>
        <td>getManagerListAPI()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获得所有酒店管理人员信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回所有酒店管理人员信息</td>
    </tr>
</table>

adminui模块需要的服务接口如下：

|            服务名             |     服务     |
| :---------------------------: | :----------: |
|       AdminController.addManager       |       添加酒店工作人员账号       |
|       AdminController.getAllManagers       |       获得所有酒店管理人员信息       |

##### couponui模块

couponui模块接口规范如下：

<table>
		<td rowspan="10" style="valign='middle';"><center>couponui</center></td>
    <tr>
        <td>语法</td>
        <td>hotelTargetMoneyAPI(data)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加酒店满减优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加酒店满减优惠策略并返回</td>
    </tr>
    <tr>
        <td>语法</td>
        <td>hotelAllCouponsAPI(hotelId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要查看指定酒店提供的所有优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回指定酒店提供的所有优惠策略</td>
    </tr>
    <tr>
        <td>语法</td>
        <td>orderMatchCouponsAPI(params)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取指定订单可用的优惠策略列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回指定订单可用的优惠策略列表</td>
    </tr>
</table>

couponui模块需要的服务接口如下：

|            服务名             |     服务     |
| :---------------------------: | :----------: |
|       CouponController.addHotelTargetMoneyCoupon       |       添加酒店满减优惠策略       |
|       CouponController.getHotelAllCoupons       |       查看某个酒店提供的所有优惠策略       |
|       CouponController.getOrderMatchCoupons       |       获取指定订单可用的优惠策略列表       |

##### orderui模块

orderui模块接口规范如下：

<table>
		<td rowspan="10" style="valign='middle';"><center>orderui</center></td>
    <tr>
        <td>语法</td>
        <td>getAllOrdersAPI()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获得所有订单信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回所有订单信息</td>
    </tr>
    <tr>
        <td>语法</td>
        <td>getUserOrdersAPI(data)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获得指定用户的所有订单信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回指定用户的所有订单信息</td>
    </tr>
    <tr>
        <td>语法</td>
        <td>cancelOrderAPI(orderId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要撤销订单</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>撤销订单并返回撤销是否成功</td>
    </tr>
</table>

orderui模块需要的服务接口如下：

|            服务名             |     服务     |
| :---------------------------: | :----------: |
|       OrderController.retrieveAllOrders       |       获得所有订单信息       |
|       OrderController.retrieveUserOrders       |       获得指定用户的所有订单信息       |
|       OrderController.annulOrder       |       撤销订单       |



### 业务逻辑层分解

业务逻辑层包括多个针对界面的业务逻辑处理对象。例如，User对象负责处理登录界面的业务逻辑，Coupon对象负责优惠券界面的业务逻辑。业务逻辑层的设计如下图所示。

![](https://supernatural.oss-cn-beijing.aliyuncs.com/bl.png)

#### 职责

| 模块     | 职责                                       |
| -------- | ------------------------------------------ |
| adminbl  | 负责实现对应于网站管理人员管理界面所需服务 |
| couponbl | 负责实现优惠券界面所需的服务               |
| hotelbl  | 负责实现酒店管理界面所需的服务             |
| orderbl  | 负责实现预订、订单界面所需的服务           |
| userbl   | 负责实现对应于用户登录界面的业务逻辑       |



#### 接口规范

AdminServiceImpl模块的接口规范：

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>AdminServiceImpl.addManager</center></td>
        <td>语法</td>
        <td>public ResponseVO addManager(UserForm userForm);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加一个酒店经理用户</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加一个酒店经理用户</td>
    </tr>
    <tr>
        <td rowspan="3"><center>AdminServiceImpl.addManager</center></td>
        <td>语法</td>
        <td>public List<User> getAllManagers();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要得到所有经理的信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回所有经理信息的列表</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>User.setEmail(String email)</td>
        <td colspan="2">设置用户的email</td>
    </tr>
    <tr>
        <td>User.setPassword(String pwd)</td>
        <td colspan="2">设置用户密码</td>
    </tr>
    <tr>
        <td>User.setUserType(UserType usertype)</td>
        <td colspan="2">设置用户类型</td>
    </tr>
    <tr>
        <td>AdminMapper.addManager(User user)</td>
        <td colspan="2">在sql数据库中添加经理</td>
    </tr>
    <tr>
        <td>ResponseVO.buildFailure(String message)</td>
        <td colspan="2">返回构建失败的信息</td>
    </tr>
    <tr>
        <td>ResponseVO.buildSuccess(Object content)</td>
        <td colspan="2">返回构建成功的信息</td>
    </tr>
</table>




CouponServiceImpl

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>CouponServiceImpl.CouponServiceImpl</center></td>
        <td>语法</td>
        <td>public CouponServiceImpl(TargetMoneyCouponStrategyImpltargetMoneyCouponStrategy, TimeCouponStrategyImpl timeCouponStrategy, CouponMapper couponMapper);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要创建一个优惠券策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加一个优惠券策略</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CouponServiceImpl.getMatchOrderCoupon</center></td>
        <td>语法</td>
        <td>public List<Coupon> getMatchOrderCoupon(OrderVO orderVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>订单创建，需要得到该订单可用的所有优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回所有可用优惠策略的列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CouponServiceImpl.getHotelAllCoupon</center></td>
        <td>语法</td>
        <td>public List<Coupon> getHotelAllCoupon(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要得到指定酒店的所有优惠券信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回该酒店所有优惠券信息的列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CouponVO.addHotelTargetMoneyCoupon</center></td>
        <td>语法</td>
        <td>public CouponVO addHotelTargetMoneyCoupon(HotelTargetMoneyCouponVO couponVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加酒店满减优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加酒店满减优惠策略</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>CouponMatchStrategy.isMatch(OrderVO orderVO, Coupon coupon)</td>
        <td colspan="2">判断订单是否符合某优惠策略</td>
    </tr>
    <tr>
        <td>CouponMapper.selectByHotelId(Integer hotelId)</td>
        <td colspan="2">根据酒店选择优惠策略</td>
    </tr>
    <tr>
        <td>CouponMapper.insertCoupon(Couon coupon)</td>
        <td colspan="2">在数据库中插入优惠券</td>
    </tr>
    <tr>
        <td>Coupon.setCouponName(String couponName)</td>
        <td colspan="2">设置优惠券名称</td>
    </tr>
    <tr>
        <td>CouponVO.setId(int id);</td>
        <td colspan="2">设置优惠券id</td>
    </tr>
    <tr>
        <td>Coupon.setStatus(Integer status)</td>
        <td colspan="2">设置优惠券状态</td>
    </tr>
    <tr>
        <td>Coupon.setDiscountMoney(double discountMoney)</td>
        <td colspan="2">设置优惠券金额</td>
    </tr>
    <tr>
        <td>Coupon.setHotelId(Integer hotelId)</td>
        <td colspan="2">设置推出该优惠券的酒店类型</td>
    </tr>
    <tr>
        <td>Coupon.setTargetMoney(double targetMoney)</td>
        <td colspan="2">设置优惠券的使用门槛</td>
    </tr>
    <tr>
        <td>Coupon.setCouponType(Integer couponType)</td>
        <td colspan="2">设置优惠券类型</td>
    </tr>
    <tr>
        <td>Coupon.setDescription(String description)</td>
        <td colspan="2">设置优惠券描述</td>
    </tr>
</table>

TargetMoneyCouponStrategyImpl

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>TargetMoneyCouponStrategyImpl.isMatch</center></td>
        <td>语法</td>
        <td>public boolean isMatch(OrderVO orderVO, Coupon coupon);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要判断某订单是否可以使用某优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回订单是否可使用该优惠策略</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>Coupon.getCouponType()</td>
        <td colspan="2">返回优惠券类型</td>
    </tr>
    <tr>
        <td>OrderVO.getPrice()</td>
        <td colspan="2">返回订单原价</td>
    </tr>
    <tr>
        <td>Coupon.getTargetMoney()</td>
        <td colspan="2">返回优惠券使用门槛</td>
    </tr>
</table>

TimeCouponStrategyImpl

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>TimeCouponStrategyImpl.isMatch</center></td>
        <td>语法</td>
        <td>public boolean isMatch(OrderVO orderVO, Coupon coupon);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要判断某订单是否可以使用某优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回该订单是否可以使用某优惠策略</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td></td>
        <td colspan="2"></td>
    </tr>
</table>

HotelServiceImpl

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>HotelServiceImpl.addHotel</center></td>
        <td>语法</td>
        <td>public void addHotel(HotelVO hotelVO) throws ServiceException;</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加一个酒店</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加一个酒店</td>
    </tr>
    <tr>
        <td rowspan="3"><center>HotelServiceImpl.updateRoomInfo</center></td>
        <td>语法</td>
        <td>public void updateRoomInfo(Integer hotelId, String roomType, Integer rooms);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>预订完成，需要更新酒店房间的信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新酒店房间的信息</td>
    </tr>
    <tr>
        <td rowspan="3"><center>HotelServiceImpl.getRoomCurNum</center></td>
        <td>语法</td>
        <td>public int getRoomCurNum(Integer hotelId, String roomType);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要得到酒店目前某类型房间的数量</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回房间数量</td>
    </tr>
    <tr>
        <td rowspan="3"><center>HotelServiceImpl.retrieveHotels</center></td>
        <td>语法</td>
        <td>public List<HotelVO> retrieveHotels();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要列表获取酒店信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回酒店信息列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>HotelServiceImpl.retrieveHotelDetails</center></td>
        <td>语法</td>
        <td>public HotelVO retrieveHotelDetails(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取某家酒店详细信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回某家酒店详细信息</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>AccountService.getUserInfo(int id)</td>
        <td colspan="2">获取用户个人信息</td>
    </tr>
    <tr>
        <td>User.getUserType()</td>
        <td colspan="2">返回用户类型</td>
    </tr>
    <tr>
        <td>HotelMapper.insertHotel(Hotel hotel)</td>
        <td colspan="2">在数据库中插入酒店</td>
    </tr>
    <tr>
        <td>RoomService.updateRoomInfo(Integer hotelId, String roomType, Integer rooms)</td>
        <td colspan="2">预订酒店后更新客房房间数量</td>
    </tr>
    <tr>
        <td>RoomService.getRoomCurNum(Integer hotelId, String roomType)</td>
        <td colspan="2">获取酒店指定房间剩余数量</td>
    </tr>
    <tr>
        <td>HotelMapper.selectAllHotel()</td>
        <td colspan="2">返回所有酒店列表</td>
    </tr>
    <tr>
        <td>HotelMapper.selectById(Integer hotelId)</td>
        <td colspan="2">根据id返回酒店对象</td>
    </tr>
    <tr>
        <td>RoomService.retrieveHotelRoomInfo(hotelId)</td>
        <td colspan="2">获取某个酒店的全部房间信息</td>
    </tr>
    <tr>
        <td>RoomVO.setId(Integer id)</td>
        <td colspan="2">设置房间id</td>
    </tr>
    <tr>
        <td>RoomVO.setPrice(Double price)</td>
        <td colspan="2">返回房间价格</td>
    </tr>
    <tr>
        <td>RoomVO.setRoomType(String roomType)</td>
        <td colspan="2">返回房间类型</td>
    </tr>
    <tr>
        <td>RoomVO.setCurNum(Integer curNum)</td>
        <td colspan="2">设置当前房间数量</td>
    </tr>
    <tr>
        <td>RoomVO.setTotal(Integer total)</td>
        <td colspan="2">设置房间总数</td>
    </tr>
    <tr>
        <td>Hotel.setAddress(String address)</td>
        <td colspan="2">设置酒店地址</td>
    </tr>
    <tr>
        <td>Hotel.setBizRegion(BizRegion bizRegion)</td>
        <td colspan="2">设置酒店商圈</td>
    </tr>
    <tr>
        <td>Hotel.setRate(Double rate)</td>
        <td colspan="2">设置酒店评分</td>
    </tr>
    <tr>
        <td>Hotel.setManagerId(Integer managerId)</td>
        <td colspan="2">设置酒店经理</td>
    </tr>
    <tr>
        <td>Hotel.setPhoneNum(String phoneNum)</td>
        <td colspan="2">设置酒店电话</td>
    </tr>
    <tr>
        <td>Hotel.setHotelName(String hotelName)</td>
        <td colspan="2">设置酒店名称</td>
    </tr>
    <tr>
        <td>Hotel.setHotelStar(HotelStar hotelStar)</td>
        <td colspan="2">设置酒店星级</td>
    </tr>
    <tr>
        <td>HotelVO.setRooms(List<RoomVO> rooms)</td>
        <td colspan="2">设置酒店房间</td>
    </tr>
    <tr>
        <td>Hotel.setDescription(String description)</td>
        <td colspan="2">设置酒店描述</td>
    </tr>
</table>

RoomServiceImpl

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>RoomServiceImpl.retrieveHotelRoomInfo</center></td>
        <td>语法</td>
        <td>List<HotelRoom> retrieveHotelRoomInfo(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取某个酒店的全部房间信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回某个酒店的全部房间信息的列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>RoomServiceImpl.insertRoomInfo</center></td>
        <td>语法</td>
        <td>void insertRoomInfo(HotelRoom hotelRoom);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加酒店客房信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加酒店客房信息</td>
    </tr>
    <tr>
        <td rowspan="3"><center>RoomServiceImpl.updateRoomInfo</center></td>
        <td>语法</td>
        <td>void updateRoomInfo(Integer hotelId, String roomType, Integer rooms);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>预订酒店后，需要更新客房房间数量</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新客房房间数量</td>
    </tr>
    <tr>
        <td rowspan="3"><center>RoomServiceImpl.getRoomCurNum</center></td>
        <td>语法</td>
        <td>int getRoomCurNum(Integer hotelId, String roomType);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取酒店指定房间剩余数量</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回酒店指定房间剩余数量</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>RoomMapper.selectRoomsByHotelId(@Param("hotelId") Integer hotelId)</td>
        <td colspan="2">返回指定id的酒店的全部房间信息列表</td>
    </tr>
    <tr>
        <td>RoomMapper.insertRoom(HotelRoom hotelRoom)</td>
        <td colspan="2">在数据库中插入房间</td>
    </tr>
    <tr>
        <td>RoomMapper.updateRoomInfo(@Param("hotelId") Integer hotelId,@Param("roomType") String roomType,@Param("curNum") Integer curNum)</td>
        <td colspan="2">在数据库中更新房间信息</td>
    </tr>
    <tr>
        <td>RoomMapper.getRoomCurNum(@Param("hotelId") Integer hotelId,@Param("roomType") String roomType)</td>
        <td colspan="2">返回指定酒店的指定类型房间的当前数量</td>
    </tr>
</table>

OrderServiceImpl

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>OrderServiceImpl.getHotelOrders</center></td>
        <td>语法</td>
        <td>public List<Order> getHotelOrders(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要查看酒店的所有订单</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回酒店的所有订单的列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>OrderServiceImpl.addOrder</center></td>
        <td>语法</td>
        <td>ResponseVO addOrder(OrderVO orderVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要预订酒店</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>增加订单</td>
    </tr>
    <tr>
        <td rowspan="3"><center>OrderServiceImpl.getAllOrders</center></td>
        <td>语法</td>
        <td>List<Order> getAllOrders();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获得所有订单信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回所有订单信息</td>
    </tr>
    <tr>
        <td rowspan="3"><center>OrderServiceImpl.getUserOrders</center></td>
        <td>语法</td>
        <td>List<Order> getUserOrders(int userid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获得指定用户的所有订单信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回指定用户的所有订单信息</td>
    </tr>
    <tr>
        <td rowspan="3"><center>OrderServiceImpl.annulOrder</center></td>
        <td>语法</td>
        <td>ResponseVO annulOrder(int orderid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要撤销订单</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>订单撤销</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>OrderService.getAllOrders()</td>
        <td colspan="2">获得所有订单信息</td>
    </tr>
    <tr>
        <td>Order.getHotelId()</td>
        <td colspan="2">回到酒店id</td>
    </tr>
    <tr>
        <td>OrderVO.getRoomNum()</td>
        <td colspan="2">获得预订房间数量</td>
    </tr>
    <tr>
        <td>HotelService.getRoomCurNum(Integer hotelId,String roomType)</td>
        <td colspan="2">查看酒店剩余某种房间数量</td>
    </tr>
    <tr>
        <td>ResponseVO.buildFailure(String message)</td>
        <td colspan="2">返回构建失败的信息</td>
    </tr>
    <tr>
        <td>OrderVO.setCreateDate(Integer createDate)</td>
        <td colspan="2">设置订单创建日期</td>
    </tr>
    <tr>
        <td>OrderVO.setOrderState(String state)</td>
        <td colspan="2">设置订单状态</td>
    </tr>
    <tr>
        <td>AccountService.getUserInfo(int id)</td>
        <td colspan="2">获取用户个人信息</td>
    </tr>
    <tr>
        <td>OrderVO.setClientName(String clientName)</td>
        <td colspan="2">设置客户名称</td>
    </tr>
    <tr>
        <td>OrderVO.setPhoneNumber(String phoneNumber)</td>
        <td colspan="2">设置客户电话</td>
    </tr>
    <tr>
        <td>OrderMapper.addOrder(Order order)</td>
        <td colspan="2">添加订单</td>
    </tr>
    <tr>
        <td>HotelService.updateRoomInfo(Integer hotelId, String roomType,Integer rooms)</td>
        <td colspan="2">预订酒店修改剩余客房信息</td>
    </tr>
    <tr>
        <td>ResponseVO.buildSuccess(Object content)</td>
        <td colspan="2">返回构建成功的信息</td>
    </tr>
    <tr>
        <td>BeanUtils.copyProperties(@NotNull Object source, @NotNull Object target)</td>
        <td colspan="2">信息拷贝</td>
    </tr>
    <tr>
        <td>OrderMapper.getAllOrders()</td>
        <td colspan="2">返回全部订单</td>
    </tr>
    <tr>
        <td>OrderMapper.getUserOrders(int userid)</td>
        <td colspan="2">返回某客户的全部订单</td>
    </tr>
</table>

AccountServiceImpl

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>AccountServiceImpl.registerAccount</center></td>
        <td>语法</td>
        <td>ResponseVO registerAccount(UserVO userVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要注册账号</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加账号</td>
    </tr>
    <tr>
        <td rowspan="3"><center>AccountServiceImpl.login</center></td>
        <td>语法</td>
        <td>User login(UserForm userForm);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>用户需要登录</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>登录成功，将用户信息保存在session中</td>
    </tr>
    <tr>
        <td rowspan="3"><center>AccountServiceImpl.getUserInfo</center></td>
        <td>语法</td>
        <td>User getUserInfo(int id);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取用户个人信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回用户个人信息</td>
    </tr>
    <tr>
        <td rowspan="3"><center>AccountServiceImpl.updateUserInfo</center></td>
        <td>语法</td>
        <td>ResponseVO updateUserInfo(int id, String password,String username,String phonenumber);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要更新用户个人信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新用户个人信息</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>AccountMapper.createNewAccount(user)</td>
        <td colspan="2">设置用户的email</td>
    </tr>
    <tr>
        <td>ResponseVO.buildSuccess(Object content)</td>
        <td colspan="2">返回构建成功信息</td>
    </tr>
    <tr>
        <td>ResponseVO.buildFailure(String message)</td>
        <td colspan="2">返回构建失败信息</td>
    </tr>
    <tr>
        <td>AccountMapper.getAccountByName(String email)</td>
        <td colspan="2">根据用户名查找账号</td>
    </tr>
    <tr>
        <td>User.getPassword()</td>
        <td colspan="2">返回用户密码</td>
    </tr>
    <tr>
        <td>UserForm.getPassword())</td>
        <td colspan="2">返回用户填写的密码</td>
    </tr>
    <tr>
        <td>UserForm.getEmail()</td>
        <td colspan="2">返回用户填写的email</td>
    </tr>
    <tr>
        <td>AccountMapper.getAccountById(int id)</td>
        <td colspan="2">根据id查找账号</td>
    </tr>
    <tr>
        <td>AccountMapper.updateAccount(@Param("id") int id, @Param("password") String password,@Param("userName") String username, @Param("phoneNumber") String phonenumber)</td>
        <td colspan="2">更新用户信息</td>
    </tr>
</table>


### 数据层分解

数据层主要给业务逻辑层提供数据访问服务，包括对于持久化数据的增、删、改、查。Admin业务逻辑需要需要的服务由AdminMapper接口提供；Coupon业务逻辑需要需要的服务由CouponMapper接口提供；Credit业务逻辑需要需要的服务由CreditMapper接口提供；Comment业务逻辑需要需要的服务由CommentMapper接口提供；Hotel业务逻辑需要需要的服务由HotelMapper接口提供；MyTag业务逻辑需要需要的服务由MyTagMapper接口提供；Room业务逻辑需要需要的服务由RoomMapper接口提供；Broadcast业务逻辑需要需要的服务由BroadcastMapper接口提供；Message业务逻辑需要需要的服务由MessageMapper接口提供；Order业务逻辑需要需要的服务由OrderMapper接口提供；Account业务逻辑需要需要的服务由AccountMapper接口提供；Member业务逻辑需要需要的服务由MemberMapper接口提供。本项目持久化数据的保存方式为数据库，所示抽象了数据服务。数据层模块的描述具体如图所示。

![](https://supernatural.oss-cn-beijing.aliyuncs.com/1.png)

![](https://supernatural.oss-cn-beijing.aliyuncs.com/2.png)

![](https://supernatural.oss-cn-beijing.aliyuncs.com/3.png)

![](https://supernatural.oss-cn-beijing.aliyuncs.com/4.png)

![](https://supernatural.oss-cn-beijing.aliyuncs.com/5.png)

![](https://supernatural.oss-cn-beijing.aliyuncs.com/6.png)

![](https://supernatural.oss-cn-beijing.aliyuncs.com/7.png)

![](https://supernatural.oss-cn-beijing.aliyuncs.com/8.png)

![](https://supernatural.oss-cn-beijing.aliyuncs.com/9.png)

![](https://supernatural.oss-cn-beijing.aliyuncs.com/10.png)

![](https://supernatural.oss-cn-beijing.aliyuncs.com/11.png)

![](https://supernatural.oss-cn-beijing.aliyuncs.com/12.png)



#### 职责

|        模块        | 职责                                                        |
| :----------------: | ----------------------------------------------------------- |
|    AdminMapper     | 持久化数据库的接口，提供增、查服务                          |
|    CouponMapper    | 持久化数据库的接口，提供增、查、删服务                      |
|    HotelMapper     | 持久化数据库的接口，提供增、删、改、查服务                  |
|     RoomMapper     | 持久化数据库的接口，提供增、查、改服务                      |
|    OrderMapper     | 持久化数据库的接口，提供增、查、改服务                      |
|   AccountMapper    | 持久化数据库的接口，提供增、改、查、删服务                  |
|   dataImpl.admin   | 基于Mysql数据库的持久化数据库的接口，提供增、查服务         |
|  dataImpl.coupon   | 基于Mysql数据库的持久化数据库的接口，提供增、查、删服务     |
|   dataImpl.hotel   | 基于Mysql数据库的持久化数据库的接口，提供增、删、改、查服务 |
|   dataImpl.order   | 基于Mysql数据库的持久化数据库的接口，提供增、查、改服务     |
|  dataImpl.account  | 基于Mysql数据库的持久化数据库的接口，提供增、改、查、删服务 |
|    CreditMapper    | 持久化数据库的接口，提供增、改、查服务                      |
|  dataImpl.credit   | 基于Mysql数据库的持久化数据库的接口，提供增、改、查服务     |
|   CommentMapper    | 持久化数据库的接口，提供增、改、查服务                      |
|  dataImpl.comment  | 基于Mysql数据库的持久化数据库的接口，提供增、改、查服务     |
|    MyTagMapper     | 持久化数据库的接口，提供增、删、查服务                      |
|   dataImpl.myTag   | 基于Mysql数据库的持久化数据库的接口，提供增、删、查服务     |
|   dataImpl.room    | 基于Mysql数据库的持久化数据库的接口，提供增、改、查服务     |
|  BroadcastMapper   | 持久化数据库的接口，提供增、查、改服务                      |
| dataImpl.broadcast | 基于Mysql数据库的持久化数据库的接口，提供增、改、查服务     |
|   MessageMapper    | 持久化数据库的接口，提供增、查、改服务                      |
|  dataImpl.message  | 基于Mysql数据库的持久化数据库的接口，提供增、改、查服务     |
|    MemberMapper    | 持久化数据库的接口，提供增、查、改服务                      |
|  dataImpl.member   | 基于Mysql数据库的持久化数据库的接口，提供增、改、查服务     |


#### 接口规范

|                 方法                  | 语法                                                         | 前置条件                      | 后置条件                                |
| :-----------------------------------: | ------------------------------------------------------------ | ----------------------------- | --------------------------------------- |
|        AdminMapper.addOperator        | int addOperator(User user);                                  | 同样的po在数据库中不存在      | 在数据库中增加一个po记录                |
|        AdminMapper.addManager         | int addManager(User user);                                   | 同样的po在数据库中不存在      | 在数据库中增加一个po记录                |
|      AdminMapper.getAllManagers       | List<User> getAllManagers();                                 | 无                            | 返回所有的User结果                      |
|       AdminMapper.getAllClients       | List<User> getAllClients();                                  | 无                            | 返回所有的User结果                      |
|      AdminMapper.getAllOperators      | List<User> getAllOperators();                                | 无                            | 返回所有的User结果                      |
|       CouponMapper.insertCoupon       | int insertCoupon(Coupon coupon);                             | 同样的po在数据库中不存在      | 在数据库中增加一个po记录                |
|     CouponMapper.selectByHotelId      | List<Coupon> selectByHotelId(Integer hotelId);               | 无                            | 按ID进行查找返回相应的Coupon列表        |
|       CouponMapper.deleteCoupon       | int deleteCoupon(Integer couponId);                          | 对应的po在数据库中存在        | 在数据库中删除一个po记录                |
|   CreditMapper.getUserCreditRecords   | List<CreditRecord> getUserCreditRecords(@Param("userId") int userId); | 无                            | 返回所有符合条件的信用记录结果          |
|     CreditMapper.getCreditRecords     | List<CreditRecord> getCreditRecords();                       | 无                            | 返回所有符合条件的信用记录结果          |
|      CreditMapper.getUserCredit       | Double getUserCredit(@Param("userId") int userId);           | 无                            | 返回所有符合条件的信用记录结果          |
|    CreditMapper.cancelCreditRecord    | int cancelCreditRecord(@Param("id") int id);                 | 对应的记录在数据库中存在      | 在数据库中删除一个信用记录              |
|    CreditMapper.insertCreditRecord    | int insertCreditRecord(CreditRecord creditRecord);           | 同样的po在数据库中不存在      | 在数据库中增加一个信用记录              |
|       CommentMapper.addComment        | int addComment(Comment comment);                             | 同样的po在数据库中不存在      | 在数据库中增加一个记录                  |
|   CommentMapper.getCommentByHotelId   | List<Comment> getCommentByHotelId(@Param("hotelId") Integer hotelId); | 无                            | 返回所有符合条件的记录结果              |
|       CommentMapper.updateReply       | int updateReply(@Param("commentId") int commentId,@Param("reply") String reply); | 对应的记录在数据库中存在      | 在数据库中更新一个记录                  |
|        HotelMapper.insertHotel        | int insertHotel(Hotel hotel);                                | 同样的po在数据中中不存在      | 在数据库中增加一个po记录                |
|      HotelMapper.selectAllHotel       | List<HotelVO> selectAllHotel();                              | 无                            | 返回所有的Hotel结果                     |
|        HotelMapper.selectById         | HotelVO selectById(@Param("id") Integer id);                 | 无                            | 按id返回HotelVO结果                     |
|       HotelMapper.setManagerId        | int setManagerId(@Param("managerId")Integer managerId,@Param("id") Integer id); | 对应的hotel记录在数据库中存在 | 更新数据库中对应的hotel记录             |
|          HotelMapper.delete           | int delete(@Param("id") Integer id);                         | 对应的记录在数据库中存在      | 在数据库中删除一个记录                  |
|          HotelMapper.update           | int update(@Param("id") int id, @Param("address") String address,@Param("phoneNum") String phoneNum); | 对应的记录在数据库中存在      | 在数据库中更新一个记录                  |
|         HotelMapper.updatePic         | int updatePic(@Param("id") int id, @Param("pic_1") String pic_1, @Param("pic_2") String pic_2, @Param("pic_3") String pic_3, @Param("pic_4") String pic_4, @Param("pic_5") String pic_5, @Param("pic_6") String pic_6, @Param("pic_7") String pic_7, @Param("pic_8") String pic_8); | 对应的记录在数据库中存在      | 在数据库中更新一个记录                  |
|     MyTagMapper.getTagsByHotelId      | List<MyTag> getTagsByHotelId(int hotel);                     | 无                            | 返回所有的查询结果                      |
|        MyTagMapper.deleteById         | int deleteById(int id);                                      | 对应的记录在数据库中存在      | 在数据库中删除一个记录                  |
|          MyTagMapper.insert           | int insert(MyTag myTag);                                     | 无                            | 在数据库中增加一个po记录                |
| MyTagMapper.selectByHotelIdAndTagName | List<MyTag> selectByHotelIdAndTagName(String tagName,int hotelId); | 无                            | 返回所有的查询结果                      |
|       RoomMapper.updateRoomInfo       | int updateRoomInfo(@Param("hotelId") Integer hotelId,@Param("roomType") String roomType,@Param("curNum") Integer curNum); | 在数据库中存在同样id的po      | 更新一个po                              |
|         RoomMapper.insertRoom         | int insertRoom(HotelRoom hotelRoom);                         | 同样的po在数据库中不存在      | 在数据库中增加一个po记录                |
|    RoomMapper.selectRoomsByHotelId    | List<HotelRoom> selectRoomsByHotelId(@Param("hotelId") Integer hotelId); | 无                            | 返回对应的HotelRoom结果                 |
|       RoomMapper.getRoomCurNum        | int getRoomCurNum(@Param("hotelId") Integer hotelId,@Param("roomType") String roomType); | 无                            | 按hotelId、roomType返回对应的RoomCurNum |
|         RoomMapper.updateRoom         | int updateRoom(@Param("hotelId") Integer hotelId,@Param("roomType") String roomType,               @Param("curNum") Integer curNum,@Param("total") Integer total,@Param("price") Double price); | 在数据库中存在对应po          | 更新po                                  |
|   BroadcastMapper.getBroadcastList    | List<Broadcast> getBroadcastList();                          | 无                            | 返回对应的Broadcast结果                 |
| BroadcastMapper.changeBroadcastStatus | void changeBroadcastStatus(@Param("id") int id, @Param("status") String status); | 在数据库中存在对应po          | 更新po                                  |
|    BroadcastMapper.updatePriority     | void updatePriority(@Param("id") int id, @Param("priority") int priority); | 在数据库中存在对应po          | 更新po                                  |
|    BroadcastMapper.insertBroadcast    | Integer insertBroadcast(Broadcast broadcast);                | 无                            | 在数据库中增加一个po记录                |
|       MessageMapper.getQuesById       | List<Message> getQuesById(@Param("toId") int toId);          | 无                            | 返回对应的Message结果                   |
|  MessageMapper.getQuesForClientById   | List<Message> getQuesForClientById(@Param("fromId") int fromId); | 无                            | 返回对应的Message结果                   |
|       MessageMapper.getChatById       | List<Message> getChatById(@Param("id") int id);              | 无                            | 返回对应的Message结果                   |
|    MessageMapper.getPrivateAdById     | List<Message> getPrivateAdById(@Param("toId") int toId);     | 无                            | 返回对应的Message结果                   |
|      MessageMapper.getAdSentById      | List<Message> getAdSentById(@Param("fromId") int fromId);    | 无                            | 返回对应的Message结果                   |
|       MessageMapper.getGroupMsg       | List<Message> getGroupMsg();                                 | 无                            | 返回对应的Message结果                   |
|      MessageMapper.insertMessage      | Integer insertMessage(Message message);                      | 同样的po在数据库中不存在      | 在数据库中增加一个po记录                |
|   MessageMapper.changeMessageStatus   | void changeMessageStatus(@Param("id") int id, @Param("status") String status); | 同样的po在数据库中存在        | 在数据库中更新一个po记录                |
|         OrderMapper.addOrder          | int addOrder(Order order);                                   | 同样po在数据库中不存在        | 在数据库中增加一个po记录                |
|       OrderMapper.getAllOrders        | List<Order> getAllOrders();                                  | 无                            | 返回所有的Oder记录                      |
|       OrderMapper.getUserOrders       | List<Order> getUserOrders(@Param("userid") int userid);      | 无                            | 按userid返回对应的Order记录             |
|        OrderMapper.annulOrder         | int annulOrder(@Param("orderid") int orderid);               | 无                            | 按orderid返回对应的记录                 |
|       OrderMapper.getOrderById        | Order getOrderById(@Param("orderid") int orderid);           | 无                            | 按oderid返回对应的Order记录             |
|       OrderMapper.changeStatus        | int changeStatus(@Param("orderid") int orderid,@Param("status") String status); | 同样的po在数据库中存在        | 在数据库中更新一个po记录                |
|       OrderMapper.getPriceById        | Double getPriceById(@Param("orderid") int orderid);          | 无                            | 返回对应的Order记录                     |
|         OrderMapper.getUserId         | Integer getUserId(@Param("orderid") int orderid);            | 无                            | 返回对应的Order记录                     |
|          OrderMapper.setCrid          | Integer setCrid(@Param("orderid") int orderid, @Param("crid") int crid); | 同样的po在数据库中存在        | 在数据库中更新一个po记录                |
|    OrderMapper.changeCommentStatus    | void changeCommentStatus(@Param("orderId") int orderId);     | 同样的po在数据库中存在        | 在数据库中更新一个po记录                |
|    AccountMapper.createNewAccount     | int createNewAccount(User user);                             | 相同的User在数据库中不存在    | 在数据库中增加一个po记录                |
|    AccountMapper.getAccountByName     | User getAccountByName(@Param("email") String email);         | 无                            | 按email进行查找返回对应的User结果       |
|     AccountMapper.getAccountById      | User getAccountById(@Param("id") int id);                    | 无                            | 按id进行查找返回相应的User结果          |
|      AccountMapper.updateAccount      | int updateAccount(@Param("id") int id, @Param("password") String password,@Param("userName") String username, @Param("phoneNumber") String phonenumber); | 在数据库中存在相同id的po      | 更新一个po                              |
|       AccountMapper.deleteUser        | int deleteUser(@Param("id") int id);                         | 在数据库中存在相同id的po      | 更新一个po                              |
|        AccountMapper.searchOO         | List<User> searchOO(@Param("keyword") String keyword);       | 无                            | 返回相应的User结果                      |
|      AccountMapper.searchClient       | List<User> searchClient(@Param("keyword") String keyword);   | 无                            | 返回相应的User结果                      |
|     AccountMapper.getUsernameById     | String getUsernameById(@Param("id") int id);                 | 无                            | 返回相应的User结果                      |
|          MemberMapper.insert          | int insert(Member member);                                   | 同样的po在数据库中不存在      | 在数据库中增加一个po记录                |
|         MemberMapper.getInfo          | Member getInfo(@Param("userId")int userId);                  | 无                            | 返回相应的User结果                      |
|          MemberMapper.update          | int update(@Param("memberPoints") double memberPoints,@Param("userId") int userId); | 同样的po在数据库中存在        | 更新一个po                              |




### 信息视角

- 描述数据持久化对象(PO)

  - 属性及其定义

    1. User: 用户ID，电子邮箱，密码，用户名，手机号码，信用值，客户类型，会员类型，生日，头像，创建日期

    ![](https://supernatural.oss-cn-beijing.aliyuncs.com/User.png)

    2. Order: 订单ID，用户ID，酒店ID，酒店名称，入住时间，退房时间，房间类型，房间数量，人数，是否带有儿童，订单创建日期，价格，客户名，手机号码，订单状态，取消原因，客户名，信用修改条目号，是否已评论

    ![](https://supernatural.oss-cn-beijing.aliyuncs.com/Order.png)

    3. HotelRoom: 房间ID，房间类型，酒店ID，价格，剩余房间数，房间总数

    <img src="https://supernatural.oss-cn-beijing.aliyuncs.com/hotelroom定义.jpg" style="zoom:50%;" />

    4. Hotel: 酒店ID，酒店名称，酒店地址，商圈，酒店星级，评分，描述，联系电话，酒店管理员ID，酒店图片1，酒店图片2，酒店图片3，酒店图片4，酒店图片5，酒店图片6，酒店图片7，酒店图片8

    ![](https://supernatural.oss-cn-beijing.aliyuncs.com/Hotel.png)

    5. Coupon:优惠券ID，描述，酒店ID，优惠券类型，优惠券名称，使用门槛，折扣，使用时间，失效时间，状态

    <img src="https://supernatural.oss-cn-beijing.aliyuncs.com/coupon定义.jpg" style="zoom:50%;" />

    6. Broadcast: 广播id，创建id，创建时间，标题，内容，状态，优先级
    
       ![](https://supernatural.oss-cn-beijing.aliyuncs.com/Broadcast.png)
    
    7. Comment: 评论id，用户id，酒店id，订单id，评分，评价内容，头像，用户名，回复
    
       ![](https://supernatural.oss-cn-beijing.aliyuncs.com/Comment.png)
    
       8. CreditRecord: 记录id，用户id，信用值，创建日期，更新日期，状态，描述
    
          ![](https://supernatural.oss-cn-beijing.aliyuncs.com/CreditRecord.png)
    
       9. Member：用户id，积分点数，生日
    
          ![](https://supernatural.oss-cn-beijing.aliyuncs.com/Member.png)
    
         10. Message：消息id，发送时间，状态，标题，内容，发信，收信，消息类型，返回消息id
    
             ![](https://supernatural.oss-cn-beijing.aliyuncs.com/Message.png)
    
         11. MyTag：标签id，名称，酒店id
    
             ![](https://supernatural.oss-cn-beijing.aliyuncs.com/MyTag.png)
  - 类型
  
    1. User​
    
       id: Integer,email: String,password: String,userName: String,phoneNumber: String,credit: double,userType: UserType, membership:int, bithday:String, avatar_url:String, createYime:LocalDate
    
    2. Order
    
       id: Integer,useId: Integer,hotelId: Integer,hotelName: String,checkInDate: String,checkOutDate: String,roomType: String,roomNum: Integer,peopleNum: Integer,havaChild: boolean,createDate: String,price: double,clientName: String,phoneNumber: String,oderState: String, cancelReason:String, residentName: String, crid:Integer, whetherComment:Integer
    
    3. HotelRoom
    
       id: Integer,roomType: RoomType,hotelId: Integer,price: double,curNum: int,total: int
    
    4. Hotel
    
       id: Integer,hotelName: String,address: String,bizRegion: BizRegion,hotelStar: HotelStar,rate: Double,description: String,phoneNum: String, pic_1:String, pic_2:String, pic_3:String, pic_4:String, pic_5:String, pic_6:String, pic_7:String, pic_8:String
    
    5. Coupon
    
       id: int,description: String,hotelId: Integer,couponType: Integer,couponName: String,tagetMoney: double,discount: double,discountMoney: double,startTime: LocalDateTime,endTime: LocalDateTime,status: Integer
       
    6. Broadcast
    
       id:Integer, createdId:Integer, createdTime:Timestamp, title: String, content:String, status:String, priority:Integer
    
    7. Comment
    
       id: Integer, userId: Integer, hotelId: Integer, orderId: Integer, commentValue: Integer, commentContent: String, avatar: String, userName: String, reply: String
    
    8. CreditRecord
    
       rid: Integer, userId:Integer, credit: Double, createTime:Timestamp, updateTime:Timestamp, status:String, desc:String
    
    9. Member
    
       userId:Integer, memberPoints:Integer, birthday:LocalDate
    
    10. Message
    
        id:Integer, sendTime:Timestamp, status:String, title:String, content:String,from:Integer, to: Integer, type:MessageType,retMsgId:Integer
    
    11. MyTag
    
        id:Integer, tagName:String, hotelId:Integer