# 详细设计描述文档

## 文档修改历史

| 修改人员 | 日期 | 修改原因 | 版本号 |
| :------: | ---- | -------- | ------ |
|          |      |          | V1.0.0 |

## 目录

<!-- TOC -->

- [详细设计描述文档](#详细设计描述文档)
    - [文档修改历史](#文档修改历史)
    - [目录](#目录)
    - [1 引言](#1-引言)
        - [1.1 编制目的](#11-编制目的)
    - [2 产品概述](#2-产品概述)
    - [3 体系结构设计概述](#3-体系结构设计概述)
    - [4 结构视角](#4-结构视角)
        - [4.1 业务逻辑层的分解](#41-业务逻辑层的分解)
            - [4.1.1 hotelbl模块](#411-hotelbl模块)
                - [模块的设计，如图](#模块的设计如图)
                - [各个类的职责](#各个类的职责)
                - [模块内部类的接口规范](#模块内部类的接口规范)
                    - [CommentServiceImpl](#commentserviceimpl)
                    - [TagServiceImpl](#tagserviceimpl)
                    - [RoomServiceImpl](#roomserviceimpl)
                    - [HotelServiceImpl](#hotelserviceimpl)
            - [4.1.2 adminbl模块](#412-adminbl模块)
                - [各个类的职责](#各个类的职责-1)
                - [模块内部类的接口规范](#模块内部类的接口规范-1)
                    - [AdminServiceImpl](#adminserviceimpl)
            - [4.1.3 userbl模块](#413-userbl模块)
                - [各个类的职责](#各个类的职责-2)
                - [模块内部类的接口规范](#模块内部类的接口规范-2)
                - [AccountServiceImpl](#accountserviceimpl)
            - [4.1.4 couponbl模块](#414-couponbl模块)
                - [模块的设计，如图](#模块的设计如图-1)
                - [各个类的职责](#各个类的职责-3)
                - [模块内部类的接口规范](#模块内部类的接口规范-3)
                    - [CouponServiceImpl](#couponserviceimpl)
                    - [TargetMoneyCouponStrategyImpl](#targetmoneycouponstrategyimpl)
                    - [TimeCouponStrategyImpl](#timecouponstrategyimpl)
                    - [BirthdayCouponStrategyImpl](#birthdaycouponstrategyimpl)
                    - [FestivalCouponStrategyImpl](#festivalcouponstrategyimpl)
                    - [RoomNumCouponStrategyImpl](#roomnumcouponstrategyimpl)
            - [4.1.5 orderbl模块](#415-orderbl模块)
                - [模块的设计，如图](#模块的设计如图-2)
                - [各个类的职责](#各个类的职责-4)
                - [模块内部类的接口规范](#模块内部类的接口规范-4)
                    - [OrderServiceImpl](#orderserviceimpl)
            - [4.1.6 creditbl模块](#416-creditbl模块)
                - [4.1.6.1 模块概述](#4161-模块概述)
                - [4.1.6.2 整体结构](#4162-整体结构)
                - [4.1.6.3 模块内部类的接口规范](#4163-模块内部类的接口规范)
                    - [4.1.6.3.1 CreditController](#41631-creditcontroller)
                    - [4.1.6.3.2 CreditServiceImpl](#41632-creditserviceimpl)
                    - [4.1.6.3.3 CreditMapper](#41633-creditmapper)
                - [4.1.6.4 业务逻辑层的动态模型](#4164-业务逻辑层的动态模型)
                - [4.1.6.5 业务逻辑层的设计原理](#4165-业务逻辑层的设计原理)
            - [4.1.7 messagebl模块](#417-messagebl模块)
                - [4.1.7.1 模块概述](#4171-模块概述)
                - [4.1.7.2 整体结构](#4172-整体结构)
                - [4.1.7.3 模块内部类的接口规范](#4173-模块内部类的接口规范)
                    - [4.1.7.3.1 MessageController](#41731-messagecontroller)
                    - [4.1.7.3.2 MessageServiceImpl](#41732-messageserviceimpl)
                    - [4.1.7.3.3 BroadcastImpl](#41733-broadcastimpl)
                    - [4.1.7.3.4 MessageMapper](#41734-messagemapper)
                    - [4.1.7.3.5 BroadcastMapper](#41735-broadcastmapper)
                - [4.1.7.4 业务逻辑层的动态模型](#4174-业务逻辑层的动态模型)
                - [4.1.7.5 业务逻辑层的设计原理](#4175-业务逻辑层的设计原理)
    - [5 依赖视角](#5-依赖视角)

<!-- /TOC -->


## 1 引言

### 1.1 编制目的

本报告详细完成对酒店预订系统的详细设计，达到指导后续软件构造的目的，同时实现和测试人员及用户的沟通。
本报告面向开发人员、测试人员及最终用户而编写，是了解系统的导航。

## 2 产品概述

参考酒店预订系统用例文档和软件需求规格说明文档中对系统的概括描述

## 3 体系结构设计概述

参考酒店预订系统体系结构文档中对体系结构设计的概述

## 4 结构视角

### 4.1 业务逻辑层的分解

#### 4.1.1 hotelbl模块

##### 4.1.1.1模块概述

![](https://supernatural.oss-cn-beijing.aliyuncs.com/ljy详细设计4.1业务逻辑层的分解_hotelbl模块设计图.png)

##### 4.1.1.2各个类的职责

| 模块            | 职责                                                         |
| --------------- | ------------------------------------------------------------ |
| HotelController | 负责实现酒店列表、酒店详情、酒店评价的功能                   |
| TagController   | 负责实现酒店设施服务标签的功能                               |
| CommentService  | 负责实现评论相关业务逻辑                                     |
| HotelService    | 负责实现酒店相关业务逻辑                                     |
| RoomService     | 负责实现酒店房间的业务逻辑                                   |
| TagService      | 负责实现酒店设施服务标签的业务逻辑                           |
| Comment         | 酒店评论的领域模型对象，拥有评论内容、回复内容等信息，用于存放交给数据库的评论数据 |
| CommentVO       | 酒店评论的领域模型对象，拥有评论内容、回复内容等信息，用于存放交给前端的评论数据 |
| Hotel           | 酒店的领域模型对象，拥有名称、地址、星级等基本信息，用于存放交给数据库的酒店信息数据 |
| HotelVO         | 酒店的领域模型对象，拥有名称、地址、星级等基本信息，用于存放交给前端的酒店信息数据 |
| HotelRoom       | 酒店房间的领域模型对象，用于存放交给数据库的房间信息数据     |
| RoomVO          | 酒店房间的领域模型对象，用于存放交给前端的房间信息数据       |
| Order           | 预订订单的领域模型对象，用于查看某用户是否预订过一家酒店     |
| MyTag           | 酒店设施服务的领域模型对象，拥有一项设施服务标签的名称、所属酒店等信息 |

##### 4.1.1.3模块内部类的接口规范


###### CommentServiceImpl

<table>
    <tr>
    	<td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>CommentServiceImpl.addComment</center></td>
        <td>语法</td>
        <td>public ResponseVO addComment(CommentVO commentVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加一条评论</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加一条评论</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CommentServiceImpl.getCommentByHotelId</center></td>
        <td>语法</td>
        <td>public List<Comment> getCommentByHotelId(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取酒店的全部评论</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>获取酒店的评论列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CommentServiceImpl.updateReply</center></td>
        <td>语法</td>
        <td>public ResponseVO updateReply(int commentId,String reply);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要更新回复</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新回复</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>CommentMapper.addComment(Comment comment)</center></td>
        <td colspan="2">增加评论</center></td>
    </tr>
    <tr>
        <td>CommentMapper.getCommentByHotelId(int hotelId)</center></td>
        <td colspan="2">获取酒店评论</center></td>
    </tr>
    <tr>
        <td>CommentMapper.updateReply(int commentId,String reply)</center></td>
        <td colspan="2">更新评论</center></td>
    </tr>
    <tr>
        <td>ResponseVO.buildFailure(String message)</td>
        <td colspan="2">返回构建失败的信息</td>
    </tr>
    <tr>
        <td>ResponseVO.buildSuccess(Object content)</td>
        <td colspan="2">返回构建成功的信息</td>
    </tr>
</table>    



###### TagServiceImpl

<table>
    <tr>
    	<td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
    	<td rowspan="3"><center>TagServiceImpl.getTagsByHotelId</center></td>
   		<td>语法</td>
        <td>public List<MyTag> getTagsByHotelId(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取酒店服务标签</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>获取酒店服务标签</td>
    </tr>
    <tr>
    	<td rowspan="3"><center>TagServiceImpl.save</center></td>
   		<td>语法</td>
        <td>public ResponseVO save(String tagName,Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加酒店服务标签</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加酒店服务标签</td>
    </tr>
    <tr>
    	<td rowspan="3"><center>TagServiceImpl.deleteById</center></td>
   		<td>语法</td>
        <td>public ResponseVO deleteById(Integer id);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要删除酒店服务标签</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除酒店服务标签</td>
    </tr>
    <tr>
    	<td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
    	<td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
    	<td>MyTagMapper.getTagsByHotelId(int hotelId);</center></td>
        <td colspan="2">获取酒店全部标签</center></td>
    </tr>
    <tr>
    	<td>MyTagMapper.deleteById(int id)</center></td>
        <td colspan="2">删除标签</center></td>
    </tr>
    <tr>
    	<td>MyTagMapper.selectByHotelIdAndTagName(String tagName,int hotelId)</center></td>
        <td colspan="2">根据标签名与酒店编号获取标签列表</center></td>
    </tr>
    <tr>
    	<td>MyTagMapper.insert(Tag tag)</center></td>
        <td colspan="2">向数据库添加标签</center></td>
    </tr>
    <tr>
    	<td>MyTag.setHotelId(int id)</td>
        <td colspan="2">设置标签所属标签</center></td>
    </tr>
    <tr>
    	<td>MyTag.setTagName(String tagName)</td>
        <td colspan="2">设置标签名称</center></td>
    </tr>
    <tr>
        <td>ResponseVO.buildFailure(String message)</td>
        <td colspan="2">返回构建失败的信息</td>
    </tr>
    <tr>
        <td>ResponseVO.buildSuccess(Object content)</td>
        <td colspan="2">返回构建成功的信息</td>
    </tr>
</table>

###### RoomServiceImpl

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>RoomServiceImpl.retrieveHotelRoomInfo</center></td>
        <td>语法</td>
        <td>List<HotelRoom> retrieveHotelRoomInfo(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取某个酒店的全部房间信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回某个酒店的全部房间信息的列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>RoomServiceImpl.insertRoomInfo</center></td>
        <td>语法</td>
        <td>void insertRoomInfo(HotelRoom hotelRoom);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加酒店客房信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加酒店客房信息</td>
    </tr>
    <tr>
        <td rowspan="3"><center>RoomServiceImpl.updateRoomInfo</center></td>
        <td>语法</td>
        <td>void updateRoomInfo(Integer hotelId, String roomType, Integer rooms);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>预订酒店后，需要更新客房房间数量</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新客房房间数量</td>
    </tr>
    <tr>
        <td rowspan="3"><center>RoomServiceImpl.getRoomCurNum</center></td>
        <td>语法</td>
        <td>int getRoomCurNum(Integer hotelId, String roomType);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取酒店指定房间剩余数量</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回酒店指定房间剩余数量</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>RoomMapper.selectRoomsByHotelId(@Param("hotelId") Integer hotelId)</td>
        <td colspan="2">返回指定id的酒店的全部房间信息列表</td>
    </tr>
    <tr>
        <td>RoomMapper.insertRoom(HotelRoom hotelRoom)</td>
        <td colspan="2">在数据库中插入房间</td>
    </tr>
    <tr>
        <td>RoomMapper.updateRoomInfo(@Param("hotelId") Integer hotelId,@Param("roomType") String roomType,@Param("curNum") Integer curNum)</td>
        <td colspan="2">在数据库中更新房间信息</td>
    </tr>
    <tr>
        <td>RoomMapper.getRoomCurNum(@Param("hotelId") Integer hotelId,@Param("roomType") String roomType)</td>
        <td colspan="2">返回指定酒店的指定类型房间的当前数量</td>
    </tr>
    <tr>
        <td>ResponseVO.buildFailure(String message)</td>
        <td colspan="2">返回构建失败的信息</td>
    </tr>
    <tr>
        <td>ResponseVO.buildSuccess(Object content)</td>
        <td colspan="2">返回构建成功的信息</td>
    </tr>
</table>

###### HotelServiceImpl


<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>HotelServiceImpl.addHotel</center></td>
        <td>语法</td>
        <td>public void addHotel(HotelVO hotelVO) throws ServiceException;</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加一个酒店</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加一个酒店</td>
    </tr>
    <tr>
        <td rowspan="3"><center>HotelServiceImpl.updateRoomInfo</center></td>
        <td>语法</td>
        <td>public void updateRoomInfo(Integer hotelId, String roomType, Integer rooms);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>预订完成，需要更新酒店房间的信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新酒店房间的信息</td>
    </tr>
    <tr>
        <td rowspan="3"><center>HotelServiceImpl.getRoomCurNum</center></td>
        <td>语法</td>
        <td>public int getRoomCurNum(Integer hotelId, String roomType);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要得到酒店目前某类型房间的数量</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回房间数量</td>
    </tr>
    <tr>
        <td rowspan="3"><center>HotelServiceImpl.retrieveHotels</center></td>
        <td>语法</td>
        <td>public List<HotelVO> retrieveHotels(Integer userid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取某用户预订过的酒店信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回预订过酒店信息列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>HotelServiceImpl.getAllHotels</center></td>
        <td>语法</td>
        <td>public List<HotelVO> getAllHotels();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取酒店信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回酒店信息列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>HotelServiceImpl.retrieveHotelDetails</center></td>
        <td>语法</td>
        <td>public HotelVO retrieveHotelDetails(Integer hotelId,Integer userid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取某用户预订过的某家酒店详细信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回某家酒店详细信息</td>
    </tr>
    <tr>
        <td rowspan="3"><center>HotelServiceImpl.getHotelInfo</center></td>
        <td>语法</td>
        <td>public HotelVO retrieveHotelDetails(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取某家酒店详细信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回某家酒店详细信息</td>
    </tr>
    <tr>
    	<td rowspan="3"><center>HotelServiceImpl.retrieveHotelByDate</center></td>
        <td>语法</td>
        <td>public List<HotelVO> retrieveHotelByDate(Integer userid, String checkInDate, String checkOutDate);</td>
    </tr>
    <tr>
    	<td>前置条件</td>
        <td>需要按照日期检索酒店</td>
    </tr>
    <tr>
    	<td>后置条件</td>
        <td>返回按照日期检索酒店结果列表</td>
    </tr>
    <tr>
    	<td rowspan="3"><center>HotelServiceImpl.updateHotelInfo</center></td>
        <td>语法</td>
        <td>public ResponseVO updateHotelInfo(int id, String address, String phoneNum);</td>
    </tr>
    <tr>
    	<td>前置条件</td>
        <td>需要更新酒店信息</td>
    </tr>
    <tr>
    	<td>后置条件</td>
        <td>返回更新酒店信息结果</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
    	<td>OrderService.hasOrderedBefore(int id)</td>
        <td colspan="2">获取客户是否预订过的信息</td>
    </tr>
    <tr>
    	<td>CouponService.getHotelAllCouponName(int id)</td>
        <td colspan="2">获取某酒店的全部优惠券</td>
    </tr>
    <tr>
        <td>AccountService.getUserInfo(int id)</td>
        <td colspan="2">获取用户个人信息</td>
    </tr>
    <tr>
        <td>User.getUserType()</td>
        <td colspan="2">返回用户类型</td>
    </tr>
    <tr>
        <td>HotelMapper.insertHotel(Hotel hotel)</td>
        <td colspan="2">在数据库中插入酒店</td>
    </tr>
    <tr>
        <td>RoomService.updateRoomInfo(Integer hotelId, String roomType, Integer rooms)</td>
        <td colspan="2">预订酒店后更新客房房间数量</td>
    </tr>
    <tr>
        <td>RoomService.getRoomCurNum(Integer hotelId, String roomType)</td>
        <td colspan="2">获取酒店指定房间剩余数量</td>
    </tr>
    <tr>
        <td>HotelMapper.selectAllHotel()</td>
        <td colspan="2">返回所有酒店列表</td>
    </tr>
    <tr>
        <td>HotelMapper.selectById(Integer hotelId)</td>
        <td colspan="2">根据id返回酒店对象</td>
    </tr>
    <tr>
        <td>RoomService.retrieveHotelRoomInfo(hotelId)</td>
        <td colspan="2">获取某个酒店的全部房间信息</td>
    </tr>
    <tr>
        <td>RoomVO.setId(Integer id)</td>
        <td colspan="2">设置房间id</td>
    </tr>
    <tr>
        <td>RoomVO.setPrice(Double price)</td>
        <td colspan="2">返回房间价格</td>
    </tr>
    <tr>
        <td>RoomVO.setRoomType(String roomType)</td>
        <td colspan="2">返回房间类型</td>
    </tr>
    <tr>
        <td>RoomVO.setCurNum(Integer curNum)</td>
        <td colspan="2">设置当前房间数量</td>
    </tr>
    <tr>
        <td>RoomVO.setTotal(Integer total)</td>
        <td colspan="2">设置房间总数</td>
    </tr>
    <tr>
        <td>Hotel.setAddress(String address)</td>
        <td colspan="2">设置酒店地址</td>
    </tr>
    <tr>
        <td>Hotel.setBizRegion(BizRegion bizRegion)</td>
        <td colspan="2">设置酒店商圈</td>
    </tr>
    <tr>
        <td>Hotel.setRate(Double rate)</td>
        <td colspan="2">设置酒店评分</td>
    </tr>
    <tr>
        <td>Hotel.setManagerId(Integer managerId)</td>
        <td colspan="2">设置酒店经理</td>
    </tr>
    <tr>
        <td>Hotel.setPhoneNum(String phoneNum)</td>
        <td colspan="2">设置酒店电话</td>
    </tr>
    <tr>
        <td>Hotel.setHotelName(String hotelName)</td>
        <td colspan="2">设置酒店名称</td>
    </tr>
    <tr>
        <td>Hotel.setHotelStar(HotelStar hotelStar)</td>
        <td colspan="2">设置酒店星级</td>
    </tr>
    <tr>
        <td>HotelVO.setRooms(List<RoomVO> rooms)</td>
        <td colspan="2">设置酒店房间</td>
    </tr>
    <tr>
        <td>Hotel.setDescription(String description)</td>
        <td colspan="2">设置酒店描述</td>
    </tr>
##### 4.1.1.4 业务逻辑层的动态模型

下图表明了添加新的酒店设施服务标签时，业务逻辑处理相关对象之间的协作。

![](https://supernatural.oss-cn-beijing.aliyuncs.com/未命名文件 (1).png)

#### 4.1.2 adminbl模块

##### 4.1.2.1 模块概述

![](https://supernatural.oss-cn-beijing.aliyuncs.com/未命名文件 (2).png)

##### 4.1.2.2 各个类的职责

| 模块            | 职责                                                         |
| --------------- | ------------------------------------------------------------ |
| AdminController | 负责实现网站管理员所提供的功能                               |
| AdminService    | 负责实现网站管理员的业务逻辑                                 |
| User            | 系统用户的领域模型对象，拥有用户数据的邮箱、用户名、密码等信息 |

##### 4.1.2.3模块内部类的接口规范

###### AdminServiceImpl

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>AdminServiceImpl.addManager</center></td>
        <td>语法</td>
        <td>public ResponseVO addManager(HotelManagerVO vo);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加一个酒店经理</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加一个酒店经理</td>
    </tr>
    <tr>
        <td rowspan="3"><center>AdminServiceImpl.addOperator</center></td>
        <td>语法</td>
        <td>public ResponseVO addOperator(UserForm userForm);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加一个运营人员</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加一个运营人员</td>
    </tr>
    <tr>
        <td rowspan="3"><center>AdminServiceImpl.getAllManagers</center></td>
        <td>语法</td>
        <td>public List<User> getAllManagers();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要得到所有经理的信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回所有经理信息的列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>AdminServiceImpl.getAllClients</center></td>
        <td>语法</td>
        <td>public List<User> getAllClients();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要得到所有客户的信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回所有客户的列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>AdminServiceImpl.getAllOperators</center></td>
        <td>语法</td>
        <td>public List<User> getAllOperators();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要得到所有运营人员的信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回所有运营人员的列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>AdminServiceImpl.deleteHM</center></td>
        <td>语法</td>
        <td>public ResponseVO deleteHM(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要删除酒店及工作人员</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除酒店及工作人员</td>
    </tr>
    <tr>
        <td rowspan="3"><center>AdminServiceImpl.getCurveDataSet</center></td>
        <td>语法</td>
        <td>public AdminCurveVO getCurveDataSet();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要绘制推广度曲线</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>获得推广度曲线所需的datasets</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>User.setEmail(String email)</td>
        <td colspan="2">设置用户的email</td>
    </tr>
    <tr>
        <td>User.setPassword(String pwd)</td>
        <td colspan="2">设置用户密码</td>
    </tr>
    <tr>
        <td>User.setUserType(UserType usertype)</td>
        <td colspan="2">设置用户类型</td>
    </tr>
    <tr>
        <td>User.setUserName(String userName)</td>
        <td colspan="2">设置用户名</td>
    </tr>
     <tr>
    	<td>User.getCreateTime()</td>
        <td colspan="2">获取用户创建时间</td>  
    </tr>
    <tr>
        <td>AdminMapper.addManager(User user)</td>
        <td colspan="2">在sql数据库中添加经理</td>
    </tr>
    <tr>
        <td>AdminMapper.addOperator(User user)</td>
        <td colspan="2">在sql数据库中添加运营人员</td>
    </tr>
    <tr>
        <td>AdminMapper.getAllManagers()</td>
        <td colspan="2">获取全部经理</td>
    </tr>
    <tr>
        <td>AdminMapper.getAllClients()</td>
        <td colspan="2">获取全部客户</td>
    </tr>
    <tr>
        <td>AdminMapper.getAllOperators()</td>
        <td colspan="2">获取全部运营人员</td>
    </tr>
    <tr>
    	<td>AccountMapper.deleteUser(Integer userId)</td>
        <td colspan="2">删除用户</td>
    </tr>
    <tr>
    	<td>HotelMapper.selectById(Integer hotelId)</td>
        <td colspan="2">获取酒店</td>
    </tr>
    <tr>
    	<td>HotelMapper.delete(Integer hotelId)</td>
        <td colspan="2">删除酒店</td>
    </tr>
    <tr>
        <td>ResponseVO.buildFailure(String message)</td>
        <td colspan="2">返回构建失败的信息</td>
    </tr>
    <tr>
        <td>ResponseVO.buildSuccess(Object content)</td>
        <td colspan="2">返回构建成功的信息</td>
    </tr>
</table>
##### 4.1.2.4 业务逻辑层的动态模型

下图表明了添加新的网站运营人员账号时，业务逻辑处理相关对象之间的协作。

![](https://supernatural.oss-cn-beijing.aliyuncs.com/未命名文件.png)

#### 4.1.3 userbl模块

##### 4.1.3.1  模块概述

userbl模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。

userbl模块的职责和接口参见软件系统结构描述文档。

##### 4.1.3.2  整体结构

| 模块              | 职责                                                         |
| ----------------- | ------------------------------------------------------------ |
| AccountController | 负责实现用户所提供的功能                                     |
| AccountService    | 负责实现用户的业务逻辑                                       |
| User              | 系统用户的领域模型对象，拥有用户数据的邮箱、用户名、密码等信息 |

##### 4.1.3.3 模块内部类的接口规范

###### AccountServiceImpl

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>AccountServiceImpl.registerAccount</center></td>
        <td>语法</td>
        <td>ResponseVO registerAccount(UserVO userVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要注册账号</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加账号</td>
    </tr>
    <tr>
        <td rowspan="3"><center>AccountServiceImpl.login</center></td>
        <td>语法</td>
        <td>User login(UserForm userForm);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>用户需要登录</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>登录成功，将用户信息保存在session中</td>
    </tr>
    <tr>
        <td rowspan="3"><center>AccountServiceImpl.getUserInfo</center></td>
        <td>语法</td>
        <td>User getUserInfo(int id);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取用户个人信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回用户个人信息</td>
    </tr>
    <tr>
        <td rowspan="3"><center>AccountServiceImpl.updateUserInfo</center></td>
        <td>语法</td>
        <td>ResponseVO updateUserInfo(int id, String password,String username,String phonenumber);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要更新用户个人信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新用户个人信息</td>
    </tr>
    <tr>
        <td rowspan="3"><center>AccountServiceImpl.deleteUser</center></td>
        <td>语法</td>
        <td>public ResponseVO deleteUser(int id);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要删除用户</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新删除用户</td>
    </tr>
    <tr>
        <td rowspan="3"><center>AccountServiceImpl.registerMem</center></td>
        <td>语法</td>
        <td>public ResponseVO registerMem(MemRegisterVO memRegisterVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要注册会员</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>注册会员</td>
    </tr>
    <tr>
        <td rowspan="3"><center>AccountServiceImpl.increaseMemberPoints</center></td>
        <td>语法</td>
        <td>public ResponseVO increaseMemberPoints(int userId, int amount);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要增加会员积分</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>增加会员积分</td>
    </tr>
    <tr>
        <td rowspan="3"><center>AccountServiceImpl.decreaseMemberPoints</center></td>
        <td>语法</td>
        <td>public ResponseVO decreaseMemberPoints(int userId, int amount);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要减少会员积分</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>减少会员积分</td>
    </tr>
    <tr>
        <td rowspan="3"><center>AccountServiceImpl.getMemInfo</center></td>
        <td>语法</td>
        <td>public MemInfoVO getMemInfo(int userId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要取得用户会员信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回用户的会员信息</td>
    </tr>
    <tr>
        <td rowspan="3"><center>AccountServiceImpl.updateAvatar</center></td>
        <td>语法</td>
        <td>public ResponseVO updateAvatar(String fileName);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要更新用户头像</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新用户头像</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>AccountMapper.createNewAccount(user)</td>
        <td colspan="2">设置用户的email</td>
    </tr>
    <tr>
        <td>ResponseVO.buildSuccess(Object content)</td>
        <td colspan="2">返回构建成功信息</td>
    </tr>
    <tr>
        <td>ResponseVO.buildFailure(String message)</td>
        <td colspan="2">返回构建失败信息</td>
    </tr>
    <tr>
        <td>AccountMapper.getAccountByName(String email)</td>
        <td colspan="2">根据用户名查找账号</td>
    </tr>
    <tr>
        <td>User.getPassword()</td>
        <td colspan="2">返回用户密码</td>
    </tr>
    <tr>
        <td>UserForm.getPassword())</td>
        <td colspan="2">返回用户填写的密码</td>
    </tr>
    <tr>
        <td>UserForm.getEmail()</td>
        <td colspan="2">返回用户填写的email</td>
    </tr>
    <tr>
        <td>AccountMapper.getAccountById(int id)</td>
        <td colspan="2">根据id查找账号</td>
    </tr>
    <tr>
        <td>AccountMapper.updateAccount(@Param("id") int id, @Param("password") String password,@Param("userName") String username, @Param("phoneNumber") String phonenumber)</td>
        <td colspan="2">更新用户信息</td>
    </tr>
    <tr>
        <td>AccountMapper.deleteUser(int id)</td>
        <td colspan="2">删除用户</td>
    </tr>
    <tr>
        <td>OrderMapper.getUserOrders</td>
        <td colspan="2">返回用户的所有订单</td>
    </tr>
    <tr>
        <td>MemberMapper.insert(int member)</td>
        <td colspan="2">插入会员记录</td>
    </tr>
    <tr>
        <td>MemberMapper.getInfo(Integer userId)</td>
        <td colspan="2">根据userId返回会员信息</td>
    </tr>
    <tr>
        <td>MemberMapper.update(Integer memberPoints)</td>
        <td colspan="2">更新积分</td>
    </tr>
</table>

##### 4.1.3.4 业务逻辑层的动态模型

下图表明了用户注册账号时，业务逻辑处理相关对象之间的协作。

![](https://supernatural.oss-cn-beijing.aliyuncs.com/user.png)

##### 4.1.3.5 业务逻辑层的设计原理

利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的领域对象。

#### 4.1.4 couponbl模块

##### 4.1.4.1  模块概述

couponbl模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。

couponbl模块的职责和接口参见软件系统结构描述文档。

##### 4.1.4.2  整体结构

###### 模块的设计，如图

![](https://ydl8023.oss-cn-beijing.aliyuncs.com/01(1).png)

###### 各个类的职责

| 模块                 | 职责                                                         |
| -------------------- | ------------------------------------------------------------ |
| AccountController    | 负责实现的功能                                               |
| OrderVO              | 订单的领域模型对象，拥有创建时间、房间类型、人数、房间数量等信息，用于存放交给前端的订单数据 |
| CouponVO             | 酒店优惠券的领域模型对象，拥有名称、折扣、所属酒店等信息，用于存放交给前端的优惠券数据 |
| TimeCouponVO         | 酒店优惠券的领域模型对象，拥有名称、折扣、所属酒店等信息，用于存放交给前端的优惠券数据 |
| HotelBirthdayVO      | 酒店优惠券的领域模型对象，拥有名称、折扣、所属酒店等信息，用于存放交给前端的优惠券数据 |
| HotelFestivalVO      | 酒店优惠券的领域模型对象，拥有名称、折扣、所属酒店等信息，用于存放交给前端的优惠券数据 |
| HotelTargetMoneyVO   | 酒店优惠券的领域模型对象，拥有名称、折扣、所属酒店等信息，用于存放交给前端的优惠券数据 |
| HotelTargetRoomNumVO | 酒店优惠券的领域模型对象，拥有名称、折扣、所属酒店等信息，用于存放交给前端的优惠券数据 |
| CouponMatchStrategy  | 负责实现优惠券匹配相关业务逻辑                               |
| CouponService        | 负责实现优惠券相关业务逻辑                                   |
| Coupon               | 酒店优惠券的领域模型对象，拥有名称、折扣、所属酒店等信息，用于存放交给数据库的优惠券数据 |

##### 4.1.4.3 模块内部类的接口规范

###### CouponServiceImpl

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>CouponServiceImpl.CouponServiceImpl</center></td>
        <td>语法</td>
        <td>public CouponServiceImpl(TargetMoneyCouponStrategyImpltargetMoneyCouponStrategy, TimeCouponStrategyImpl timeCouponStrategy, CouponMapper couponMapper);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要创建一个优惠券策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加一个优惠券策略</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CouponServiceImpl.getMatchOrderCoupon</center></td>
        <td>语法</td>
        <td>public List<Coupon> getMatchOrderCoupon(OrderVO orderVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>订单创建，需要得到该订单可用的所有优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回所有可用优惠策略的列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CouponServiceImpl.getHotelAllCoupon</center></td>
        <td>语法</td>
        <td>public List<Coupon> getHotelAllCoupon(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要得到指定酒店的所有优惠券信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回该酒店所有优惠券信息的列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CouponServiceImpl.getHotelAllCouponName</center></td>
        <td>语法</td>
        <td>public List<String> getHotelAllCouponName(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要得到指定酒店的所有优惠券名称</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回该酒店所有优惠券名称的列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CouponVO.addHotelTargetMoneyCoupon</center></td>
        <td>语法</td>
        <td>public CouponVO addHotelTargetMoneyCoupon(HotelTargetMoneyCouponVO couponVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加酒店满减优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加酒店满减优惠策略</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CouponVO.addHotelTimeCoupon</center></td>
        <td>语法</td>
        <td>public CouponVO addHotelTimeCoupon(TimeCouponVO timeCouponVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加酒店限时优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加酒店限时优惠策略</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CouponVO.addHotelTargetRoomNumCoupon</center></td>
        <td>语法</td>
        <td>public CouponVO addHotelTargetRoomNumCoupon(HotelTargetRoomNumCouponVO couponVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加酒店多间优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加酒店多间优惠策略</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CouponVO.addHotelBirthdayCoupon</center></td>
        <td>语法</td>
        <td>public CouponVO addHotelBirthdayCoupon(HotelBirthdayCouponVO couponVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加酒店生日优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加酒店生日优惠策略</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CouponVO.addHotelFestivalCoupon</center></td>
        <td>语法</td>
        <td>public CouponVO addHotelFestivalCoupon(HotelFestivalCouponVO couponVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加酒店节日优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>添加酒店节日优惠策略</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CouponVO.deleteCoupon</center></td>
        <td>语法</td>
        <td>public ResponseVO deleteCoupon(int couponId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要删除酒店优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除酒店优惠策略</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>CouponMatchStrategy.isMatch(OrderVO orderVO, Coupon coupon)</td>
        <td colspan="2">判断订单是否符合某优惠策略</td>
    </tr>
    <tr>
        <td>CouponMapper.selectByHotelId(Integer hotelId)</td>
        <td colspan="2">根据酒店选择优惠策略</td>
    </tr>
    <tr>
        <td>CouponMapper.insertCoupon(Couon coupon)</td>
        <td colspan="2">在数据库中插入优惠券</td>
    </tr>
    <tr>
        <td>Coupon.setCouponName(String couponName)</td>
        <td colspan="2">设置优惠券名称</td>
    </tr>
    <tr>
        <td>CouponVO.setId(int id);</td>
        <td colspan="2">设置优惠券id</td>
    </tr>
    <tr>
        <td>Coupon.setStatus(Integer status)</td>
        <td colspan="2">设置优惠券状态</td>
    </tr>
    <tr>
        <td>Coupon.setDiscountMoney(double discountMoney)</td>
        <td colspan="2">设置优惠券金额</td>
    </tr>
    <tr>
        <td>Coupon.setHotelId(Integer hotelId)</td>
        <td colspan="2">设置推出该优惠券的酒店类型</td>
    </tr>
    <tr>
        <td>Coupon.setTargetMoney(double targetMoney)</td>
        <td colspan="2">设置优惠券的使用门槛</td>
    </tr>
    <tr>
        <td>Coupon.setCouponType(Integer couponType)</td>
        <td colspan="2">设置优惠券类型</td>
    </tr>
    <tr>
        <td>Coupon.setDescription(String description)</td>
        <td colspan="2">设置优惠券描述</td>
    </tr>
    <tr>
        <td>CouponMapper.deleteCoupon(Integer couponId)</td>
        <td colspan="2">删除优惠券</td>
    </tr>
</table>

###### TargetMoneyCouponStrategyImpl

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>TargetMoneyCouponStrategyImpl.isMatch</center></td>
        <td>语法</td>
        <td>public boolean isMatch(OrderVO orderVO, Coupon coupon);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要判断某订单是否可以使用某优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回订单是否可使用该优惠策略</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>Coupon.getCouponType()</td>
        <td colspan="2">返回优惠券类型</td>
    </tr>
    <tr>
        <td>OrderVO.getPrice()</td>
        <td colspan="2">返回订单原价</td>
    </tr>
    <tr>
        <td>Coupon.getTargetMoney()</td>
        <td colspan="2">返回优惠券使用门槛</td>
    </tr>
</table>

###### TimeCouponStrategyImpl

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>TimeCouponStrategyImpl.isMatch</center></td>
        <td>语法</td>
        <td>public boolean isMatch(OrderVO orderVO, Coupon coupon);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要判断某订单是否可以使用某优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回该订单是否可以使用某优惠策略</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td></td>
        <td colspan="2"></td>
    </tr>
</table>

###### BirthdayCouponStrategyImpl

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>BirthdayCouponStrategyImpl.isMatch</center></td>
        <td>语法</td>
        <td>public boolean isMatch(OrderVO orderVO, Coupon coupon);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要判断某订单是否可以使用某优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回该订单是否可以使用某优惠策略</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td>AccountService.getMemInfo(int userId)</td>
        <td colspan="2">返回对应用户id的会员信息</td>
    </tr>
    <tr>
        <td>Coupon.getCouponType()</td>
        <td colspan="2">返回优惠券类型</td>
    </tr>
    <tr>
        <td></td>
        <td colspan="2"></td>
    </tr>
</table>

###### FestivalCouponStrategyImpl

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>FestivalCouponStrategyImpl.isMatch</center></td>
        <td>语法</td>
        <td>public boolean isMatch(OrderVO orderVO, Coupon coupon);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要判断某订单是否可以使用某优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回该订单是否可以使用某优惠策略</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td>OrderVO.getCreateDate()</td>
        <td colspan="2">返回订单创建日期</td>
    </tr>
    <tr>
        <td>Coupon.getCouponType()</td>
        <td colspan="2">返回优惠券类型</td>
    </tr>
    <tr>
        <td></td>
        <td colspan="2"></td>
    </tr>
</table>

###### RoomNumCouponStrategyImpl

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>RoomNumCouponStrategyImpl.isMatch</center></td>
        <td>语法</td>
        <td>public boolean isMatch(OrderVO orderVO, Coupon coupon);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要判断某订单是否可以使用某优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回该订单是否可以使用某优惠策略</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td>OrderVO.getRoomNum()</td>
        <td colspan="2">返回对应订单所需房间数</td>
    </tr>
    <tr>
        <td>Coupon.getCouponType()</td>
        <td colspan="2">返回优惠券类型</td>
    </tr>
    <tr>
        <td></td>
        <td colspan="2"></td>
    </tr>
</table>

##### 4.1.4.4 业务逻辑层的动态模型

下图表明了酒店工作人员删除优惠策略时，业务逻辑处理相关对象之间的协作。

![](https://supernatural.oss-cn-beijing.aliyuncs.com/coupon.png)

##### 4.1.4.5 业务逻辑层的设计原理

利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的领域对象。

#### 4.1.5 orderbl模块

##### 模块的设计，如图

<img src="/Users/yindelin/Library/Application Support/typora-user-images/image-20200629171200670.png" style="zoom: 50%;" />

##### 各个类的职责

| 模块            | 职责                                                         |
| --------------- | ------------------------------------------------------------ |
| OrderController | 负责实现创建订单 、撤销订单、检索订单的功能                  |
| AccountService  | 负责实现账户相关业务逻辑                                     |
| CreditService    | 负责实现信用相关业务逻辑                                     |
| OrderService     | 负责实现订单房间的业务逻辑                                   |
| MemberService      | 负责实现会员相关的业务逻辑                           |
| CurRoomNumService      | 负责实现房间剩余数量相关的业务逻辑                           |
| CurRoom | 预定订单的领域模型对象，用于查看用户预订时房间数量是否足够 |
| Order           | 预订订单的领域模型对象，用于查看某用户是否预订过一家酒店     |
| OrderVO           | 预订订单的领域模型对象，用于查看某用户是否预订过一家酒店     |
| User           | 预订订单的领域模型对象，用于创建订单时保存客户信息     |

##### 模块内部类的接口规范
###### OrderServiceImpl
<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>OrderServiceImpl.getHotelOrders</center></td>
        <td>语法</td>
        <td>public List<Order> getHotelOrders(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要查看酒店的所有订单</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回酒店的所有订单的列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>OrderServiceImpl.addOrder</center></td>
        <td>语法</td>
        <td>ResponseVO addOrder(OrderVO orderVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要预订酒店</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>增加订单</td>
    </tr>
    <tr>
        <td rowspan="3"><center>OrderServiceImpl.getAllOrders</center></td>
        <td>语法</td>
        <td>List<Order> getAllOrders();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获得所有订单信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回所有订单信息</td>
    </tr>
    <tr>
        <td rowspan="3"><center>OrderServiceImpl.getUserOrders</center></td>
        <td>语法</td>
        <td>List<Order> getUserOrders(int userid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获得指定用户的所有订单信息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回指定用户的所有订单信息</td>
    </tr>
    <tr>
        <td rowspan="3"><center>OrderServiceImpl.annulOrder</center></td>
        <td>语法</td>
        <td>ResponseVO annulOrder(int orderid,String reason,int hotelId,String roomType,String startTime,String endTime,int reserveNum);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要撤销订单</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>订单撤销</td>
    </tr>
    <tr>
        <td rowspan="3"><center>OrderServiceImpl.getOrderByHotelId</center></td>
        <td>语法</td>
        <td>public List<Order> getOrderByHotelId(int hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获得某个酒店的所有订单</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回某个酒店的所有订单的列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>OrderServiceImpl.hasOrderedBefore</center></td>
        <td>语法</td>
        <td>public boolean hasOrderedBefore(int userid, int hotelid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要判断某个用户是否预订过某个酒店</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>判断用户是否预订过某个酒店</td>
    </tr>
    <tr>
        <td rowspan="3"><center>OrderServiceImpl.getOrder</center></td>
        <td>语法</td>
        <td>public Order getOrder(int orderid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要根据orderId获得对应的order记录</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>获得order记录</td>
    </tr>
    <tr>
        <td rowspan="3"><center>OrderServiceImpl.changeStatus</center></td>
        <td>语法</td>
        <td>public ResponseVO changeStatus(int orderid,String status,int hotelId,String roomType,String startTime,String endTime,int reserveNum);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要根据orderId更改订单状态</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更改订单的状态</td>
    </tr>
    <tr>
        <td rowspan="3"><center>OrderServiceImpl.changeCommentStatus</center></td>
        <td>语法</td>
        <td>public void changeCommentStatus(int orderId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要根据orderId更改是否评价过的状态</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更改订单的是否评价状态</td>
    </tr>
    <tr>
        <td rowspan="3"><center>OrderServiceImpl.getPrice</center></td>
        <td>语法</td>
        <td>public Double getPrice(int orderId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要根据orderId获取对应的价格</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>获得价格</td>
    </tr>
    <tr>
        <td rowspan="3"><center>OrderServiceImpl.getUserId</center></td>
        <td>语法</td>
        <td>public Integer getUserId(int orderId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要根据orderId获取对应的客户Id</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>获得orderId对应的客户Id</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>OrderService.getAllOrders()</td>
        <td colspan="2">获得所有订单信息</td>
    </tr>
    <tr>
        <td>Order.getHotelId()</td>
        <td colspan="2">获得酒店id</td>
    </tr>
    <tr>
        <td>OrderVO.getRoomNum()</td>
        <td colspan="2">获得预订房间数量</td>
    </tr>
    <tr>
        <td>HotelService.getRoomCurNum(Integer hotelId,String roomType)</td>
        <td colspan="2">查看酒店剩余某种房间数量</td>
    </tr>
    <tr>
        <td>ResponseVO.buildFailure(String message)</td>
        <td colspan="2">返回构建失败的信息</td>
    </tr>
    <tr>
        <td>OrderVO.setCreateDate(Integer createDate)</td>
        <td colspan="2">设置订单创建日期</td>
    </tr>
    <tr>
        <td>OrderVO.setOrderState(String state)</td>
        <td colspan="2">设置订单状态</td>
    </tr>
    <tr>
        <td>AccountService.getUserInfo(int id)</td>
        <td colspan="2">获取用户个人信息</td>
    </tr>
    <tr>
        <td>OrderVO.setClientName(String clientName)</td>
        <td colspan="2">设置客户名称</td>
    </tr>
    <tr>
        <td>OrderVO.setPhoneNumber(String phoneNumber)</td>
        <td colspan="2">设置客户电话</td>
    </tr>
    <tr>
        <td>OrderMapper.addOrder(Order order)</td>
        <td colspan="2">添加订单</td>
    </tr>
    <tr>
        <td>HotelService.updateRoomInfo(Integer hotelId, String roomType,Integer rooms)</td>
        <td colspan="2">预订酒店修改剩余客房信息</td>
    </tr>
    <tr>
        <td>ResponseVO.buildSuccess(Object content)</td>
        <td colspan="2">返回构建成功的信息</td>
    </tr>
    <tr>
        <td>BeanUtils.copyProperties(@NotNull Object source, @NotNull Object target)</td>
        <td colspan="2">信息拷贝</td>
    </tr>
    <tr>
        <td>OrderMapper.getAllOrders()</td>
        <td colspan="2">返回全部订单</td>
    </tr>
    <tr>
        <td>OrderMapper.getUserOrders(int userid)</td>
        <td colspan="2">返回某客户的全部订单</td>
    </tr>
    <tr>
        <td>OrderMapper.getOrderByHotelId(int hotelId)</td>
        <td colspan="2">返回某酒店的全部订单</td>
    </tr>
    <tr>
        <td>orderMapper.getOrderById(orderid)</td>
        <td colspan="2">返回orderId对应的订单</td>
    </tr>
    <tr>
        <td>orderVO.setWhetherComment(0);</td>
        <td colspan="2">更改订单是否评价的状态</td>
    </tr>
    <tr>
        <td>curRoomMapper.isExist(int hotelId,String roomType,String day)</td>
        <td colspan="2">判断curRoom表中是否存在对应的记录</td>
    </tr>
    <tr><td>curRoomMapper.selectCurRoomNum(orderVO.getHotelId(),orderVO.getRoomType(),day);</td>
        <td colspan="2">获得curRoom表中对应记录的curRoomNum</td>
    </tr>
    <tr>
        <td>curRoomMapper.updateCurRoomNum(orderVO.getHotelId(),orderVO.getRoomType(),day,orderVO.getRoomNum());</td>
        <td colspan="2">更新curRoom表中对应的记录</td>
    </tr>
</table>
##### 4.1.5.4 业务逻辑层的动态模型

下图表明了创建订单时，业务逻辑处理相关对象之间的协作。

![](https://ydl8023.oss-cn-beijing.aliyuncs.com/20200629171102.png)

##### 4.1.5.5 业务逻辑层的设计原理

利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的领域对象。


#### 4.1.6 creditbl模块

##### 4.1.6.1 模块概述

creditbl模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。

creditbl模块的职责和接口参见软件系统结构描述文档。

##### 4.1.6.2 整体结构

creditbl模块的设计如图所示。

![](https://supernatural.oss-cn-beijing.aliyuncs.com/creditbl.jpg)

creditbl模块各个类的职责如表所示

| 模块            | 职责                                                         |
| --------------- | ------------------------------------------------------------ |
| CreditController | 负责实现对应信用相关界面所需要的服务   |
| CreditVO | 负责实现账户相关业务逻辑                                     |
| CreditRecordVO | 信用记录的视图对象            |
| CreditUpdateVO | 信用变更的视图对象         |
| DefaultUpdateCreditVO | 信用变更的视图对象 |
| ManualUpdateCreditVO | 信用变更的视图对象 |
| CreditService | 负责实现信用处理相关业务逻辑 |
| CreditServiceImpl | 预订订单的领域模型对象，用于查看某用户是否预订过一家酒店     |
| DefaultCreditUpdateStrategy | 负责信用变更计算策略 |
| DefaultDefaultCreditDecreImpl | 负责信用变更计算策略 |
| DefaultDefaultCreditIncreImpl | 负责信用变更计算策略 |
| CreditRecord | 信用记录的持久化对象 |
| CreditMapper | 负责信用处理数据持久化 |

##### 4.1.6.3 模块内部类的接口规范

###### 4.1.6.3.1 CreditController

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>CreditController.getCreditById</center></td>
        <td>语法</td>
        <td>public ResponseVO getCreditById(int id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个CreditService对象，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用CreditService对象的getUserCredit方法</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CreditController.decrementDefault</center></td>
        <td>语法</td>
        <td>public ResponseVO decrementDefault(String method, DefaultUpdateCreditVO defaultUpdateCreditVO)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个CreditService对象，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用CreditService对象的decrementDefault方法</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CreditController.manualUpdateCredit</center></td>
        <td>语法</td>
        <td>public ResponseVO manualUpdateCredit(ManualUpdateCreditVO manualUpdateCreditVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个CreditService对象，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用CreditService对象的manualUpdateCredit方法</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CreditController.getCreditRecords</center></td>
        <td>语法</td>
        <td>public List<CreditRecordVO> getCreditRecords()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个CreditService对象，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用CreditService对象的getCreditRecords方法</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CreditController.getUserCreditRecords</center></td>
        <td>语法</td>
        <td>public List<CreditRecordVO> getUserCreditRecords(int userId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个CreditService对象，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用CreditService对象的getCreditCurve方法</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CreditController.getUserCredit</center></td>
        <td>语法</td>
        <td>public Double getUserCredit(int userId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个CreditService对象，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用CreditService对象的getUserCredit方法</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>CreditService.initCredit(int userId, double credit)</td>
        <td colspan="2">初始化用户信用值</td>
    </tr>
    <tr>
    	<td>CreditService.defaultUpdateCredit(DefaultUpdateCreditVO defaultUpdateCreditVO, DefaultCreditUpdateStrategy defaultCreditUpdateStrategy)</td>
        <td colspan="2">采用系统默认方式更新信用值</td>
    </tr>
    <tr>
    	<td>CreditService.manualUpdateCredit(ManualUpdateCreditVO manualUpdateCreditVO)</td>
        <td colspan="2">采用手动方式更新系统默认值</td>
    </tr>
    <tr>
    	<td>CreditService.getCreditRecords()</td>
        <td colspan="2">获取信用变更记录列表</td>
    </tr>
    <tr>
        <td>CreditService.getUserCreditRecords(int userId)</td>
        <td colspan="2">获取用户信用变更记录列表</td>
    </tr>
    <tr>
        <td>CreditService.getUserCredit(int userId)</td>
        <td colspan="2">获取用户信用值</td>
    </tr>
    <tr>
        <td>CreditService.cancelCreditRecord(int id)</td>
        <td colspan="2">撤销信用变更</td>
    </tr>
    <tr>
        <td>CreditService.getCreditCurve(int userId)</td>
        <td colspan="2">获取用户信用变更曲线</td>
    </tr>
</table>

###### 4.1.6.3.2 CreditServiceImpl

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>CreditServiceImpl.initCredit</center></td>
        <td>语法</td>
        <td>public int initCredit(int userId, double credit);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要初始化用户信用值</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回是否初始化成功</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CreditServiceImpl.defaultUpdateCredit</center></td>
        <td>语法</td>
        <td>public ResponseVO defaultUpdateCredit(DefaultUpdateCreditVO defaultUpdateCreditVO, DefaultCreditUpdateStrategy defaultCreditUpdateStrategy);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要采用系统默认方式更新信用值</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回是否更新成功</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CreditServiceImpl.manualUpdateCredit</center></td>
        <td>语法</td>
        <td>public ResponseVO manualUpdateCredit(ManualUpdateCreditVO manualUpdateCreditVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要采用手动方式更新信用值</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回是否更新成功</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CreditServiceImpl.getCreditRecords</center></td>
        <td>语法</td>
        <td>public List<CreditRecordVO> getCreditRecords()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取信用变更记录列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回信用变更记录列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CreditServiceImpl.getUserCreditRecords</center></td>
        <td>语法</td>
        <td>public List<CreditRecordVO> getUserCreditRecords(int userId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取用户信用变更记录列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回用户信用变更记录列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CreditServiceImpl.getUserCredit</center></td>
        <td>语法</td>
        <td>public Double getUserCredit(int userId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取用户信用值</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回用户信用值</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CreditServiceImpl.cancelCreditRecord</center></td>
        <td>语法</td>
        <td>public ResponseVO cancelCreditRecord(int id);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要撤销信用变更</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回是否撤销成功</td>
    </tr>
    <td rowspan="3"><center>CreditServiceImpl.getCreditCurve</center></td>
        <td>语法</td>
        <td>public CreditCurveVO getCreditCurve(int userId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取信用变更曲线</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回信用变更曲线</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>CreditRecord.setUserId(Integer userId)</td>
        <td colspan="2">设置信用记录所属用户id</td>
    </tr>
    <tr>
        <td>CreditRecord.setCredit(Double credit)</td>
        <td colspan="2">设置信用记录更新后信用值</td>
    </tr>
    <tr>
        <td>CreditRecord.setCreateTime(Timestamp createTime)</td>
        <td colspan="2">设置信用记录创建时间</td>
    </tr>
     <tr>
    	<td>CreditRecord.setUpdateTime(Timestamp updateTime)</td>
        <td colspan="2">设置信用记录最后一次更新时间</td>  
    </tr>
    <tr>
        <td>CreditRecord.setStatus(String status)</td>
        <td colspan="2">设置信用记录状态</td>
    </tr>
    <tr>
        <td>CreditRecord.setDesc(String desc)</td>
        <td colspan="2">设置信用记录变更说明</td>
    </tr>
    <tr>
        <td>CreditRecord.setUser(User user)</td>
        <td colspan="2">设置信用记录所属用户信息</td>
    </tr>
    <tr>
        <td>CreditMapper.getUserCreditRecords(int userId);</td>
        <td colspan="2">获取用户信用变更记录</td>
    </tr>
    <tr>
    	<td>CreditMapper.getCreditRecords()</td>
        <td colspan="2">获取信用变更记录列表</td>
    </tr>
    <tr>
    	<td>CreditMapper.getUserCredit(int userId)</td>
        <td colspan="2">获取用户信用值</td>
    </tr>
    <tr>
    	<td>CreditMapper.cancelCreditRecord(int id)</td>
        <td colspan="2">撤销信用变更</td>
    </tr>
    <tr>
        <td>CreditMapper.insertCreditRecord(CreditRecord creditRecord)</td>
        <td colspan="2">添加信用变更记录</td>
    </tr>
    <tr>
        <td>DefaultDefaultCreditDecreImpl.getResult(Double price, Double credit)</td>
        <td colspan="2">返回系统默认增加后信用值</td>
    </tr>
    <tr>
        <td>DefaultDefaultCreditIncreImpl.getResult(Double price, Double credit)</td>
        <td colspan="2">返回系统默认减少后信用值</td>
    </tr>
</table>


###### 4.1.6.3.3 CreditMapper

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>CreditMapper.getUserCreditRecords</center></td>
        <td>语法</td>
        <td>public List<CreditRecord> getUserCreditRecords(int userId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取用户信用变更记录列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回用户信用变更记录列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CreditMapper.getCreditRecords</center></td>
        <td>语法</td>
        <td>public List<CreditRecord> getCreditRecords()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取信用变更记录列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回信用变更记录列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CreditMapper.getUserCredit</center></td>
        <td>语法</td>
        <td>public Double getUserCredit(int userId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取用户信用值</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回用户信用值</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CreditMapper.cancelCreditRecord</center></td>
        <td>语法</td>
        <td>public int cancelCreditRecord(int id);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要撤销信用变更</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回撤销是否成功</td>
    </tr>
    <tr>
        <td rowspan="3"><center>CreditMapper.insertCreditRecord</center></td>
        <td>语法</td>
        <td>public int insertCreditRecord(CreditRecord creditRecord)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加信用变更记录</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回添加是否成功</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>CreditRecord.setUserId(Integer userId)</td>
        <td colspan="2">设置信用记录所属用户id</td>
    </tr>
    <tr>
        <td>CreditRecord.setCredit(Double credit)</td>
        <td colspan="2">设置信用记录更新后信用值</td>
    </tr>
    <tr>
        <td>CreditRecord.setCreateTime(Timestamp createTime)</td>
        <td colspan="2">设置信用记录创建时间</td>
    </tr>
     <tr>
    	<td>CreditRecord.setUpdateTime(Timestamp updateTime)</td>
        <td colspan="2">设置信用记录最后一次更新时间</td>  
    </tr>
    <tr>
        <td>CreditRecord.setStatus(String status)</td>
        <td colspan="2">设置信用记录状态</td>
    </tr>
    <tr>
        <td>CreditRecord.setDesc(String desc)</td>
        <td colspan="2">设置信用记录变更说明</td>
    </tr>
    <tr>
        <td>CreditRecord.setUser(User user)</td>
        <td colspan="2">设置信用记录所属用户信息</td>
    </tr>
</table>


##### 4.1.6.4 业务逻辑层的动态模型

下图表明了网站运营人员需要变更客户信用值时，业务逻辑处理相关对象之间的协作。

![](https://supernatural.oss-cn-beijing.aliyuncs.com/变更信用【顺序图】.png)

##### 4.1.6.5 业务逻辑层的设计原理

利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的领域对象。



#### 4.1.7 messagebl模块

##### 4.1.7.1 模块概述

messagebl模块承担的需求参见需求规格说明文档功能需求及相关非功能需求。

messagebl模块的职责和接口参见软件系统结构描述文档。

##### 4.1.7.2 整体结构

messagebl模块的设计如图所示。

![](https://supernatural.oss-cn-beijing.aliyuncs.com/messagebl.jpg)

messagebl模块各个类的职责如表所示

| 模块            | 职责                                                         |
| --------------- | ------------------------------------------------------------ |
| MessageController | 负责实现对应消息相关界面所需要的服务   |
| CreditVO | 网站公告条目的视图对象                        |
| SendBroadcastVO | 发送网站公告条目的视图对象 |
| MessageVO | 聊天消息及推送消息的视图对象 |
| SendMessageVO | 发送聊天消息及推送消息的视图对象 |
| MessageService | 负责实现聊天消息及推送消息处理相关业务逻辑 |
| MessageServiceImpl | 负责实现聊天消息及推送消息处理相关业务逻辑 |
| BroadcastService | 负责实现网站公告处理相关业务逻辑 |
| BroadcastServiceImpl | 负责实现网站公告处理相关业务逻辑 |
| Message | 聊天消息及推送消息的持久化对象 |
| Broadcast | 网站公告的持久化对象 |
| MessageMapper | 负责聊天消息及推送消息数据持久化 |
| BroadcastMapper | 负责网站公告数据持久化 |

##### 4.1.7.3 模块内部类的接口规范

###### 4.1.7.3.1 MessageController

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageController.getQuesById</center></td>
        <td>语法</td>
        <td>public ResponseVO getQuesById(int id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个MessageService对象，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用MessageService对象的getQuesById方法</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageController.getQuesForClientById</center></td>
        <td>语法</td>
        <td>public ResponseVO getQuesForClientById(int id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个MessageService对象，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用MessageService对象的getQuesForClientById方法</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageController.getChatById</center></td>
        <td>语法</td>
        <td>public ResponseVO getChatById(int id);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个MessageService对象，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用MessageService对象的getChatById方法</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageController.getPrivateAd</center></td>
        <td>语法</td>
        <td>public ResponseVO getPrivateAd(int id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个MessageService对象，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用MessageService对象的getPrivateAd方法</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageController.getAdSentById</center></td>
        <td>语法</td>
        <td>public List<CreditRecordVO> getAdSentById(int userId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个MessageService对象，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用MessageService对象的getAdSentById方法</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageController.sendMessage</center></td>
        <td>语法</td>
        <td>public ResponseVO sendMessage(SendMessageVO sendMessageVO)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个MessageService对象，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用MessageService对象的sendMessage方法</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageController.changeMessageStatus</center></td>
        <td>语法</td>
        <td>public ResponseVO changeMessageStatus(int id, String status)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个MessageService对象，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用MessageService对象的changeMessageStatus方法</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageController.getBroadcastList</center></td>
        <td>语法</td>
        <td>public ResponseVO getBroadcastList()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个BroadcastService对象，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用BroadcastService对象的getBroadcastList方法</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageController.sendBroadcast</center></td>
        <td>语法</td>
        <td>public ResponseVO sendBroadcast( SendBroadcastVO sendBroadcastVO)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个BroadcastService对象，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用BroadcastService对象的sendBroadcast方法</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageController.changeBroadcastStatus</center></td>
        <td>语法</td>
        <td>public ResponseVO changeBroadcastStatus(int id,  String status)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个BroadcastService对象，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用BroadcastService对象的changeBroadcastStatus方法</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageController.updatePriority</center></td>
        <td>语法</td>
        <td>public ResponseVO updatePriority(int id, int priority)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>已创建一个BroadcastService对象，并且输入符合输入规则</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>调用BroadcastService对象的updatePriority方法</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>MessageService.getQuesById(int toId)</td>
        <td colspan="2">获取收到的留言列表</td>
    </tr>
    <tr>
    	<td>MessageService.getQuesForClientById(int fromId)</td>
        <td colspan="2">获取发送的留言列表</td>
    </tr>
    <tr>
    	<td>MessageService.getChatById(int id)</td>
        <td colspan="2">获取聊天内容</td>
    </tr>
    <tr>
    	<td>MessageService.getPrivateAd(int toId)</td>
        <td colspan="2">获取收到的推送列表</td>
    </tr>
    <tr>
        <td>MessageService.getAdSentById(int fromId)</td>
        <td colspan="2">获取发送的推送列表</td>
    </tr>
    <tr>
        <td>MessageService.sendMessage(SendMessageVO sendMessageVO)</td>
        <td colspan="2">发送聊天消息或推送</td>
    </tr>
    <tr>
        <td>MessageService.changeMessageStatus(int id, String status)</td>
        <td colspan="2">更新消息状态</td>
    </tr>
    <tr>
        <td>BroadcastService.getBroadcastList()</td>
        <td colspan="2">获取网站公告列表</td>
    </tr>
    <tr>
        <td>BroadcastService.changeBroadcastStatus(int id, String status)</td>
        <td colspan="2">更新网站公告状态</td>
    </tr>
    <tr>
        <td>BroadcastService.updatePriority(int id, int priority);</td>
        <td colspan="2">更新网站公告优先级</td>
    </tr>
    <tr>
        <td>BroadcastService.sendBroadcast(SendBroadcastVO sendBroadcastVO)</td>
        <td colspan="2">添加网站公告</td>
    </tr>
</table>


###### 4.1.7.3.2 MessageServiceImpl

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageServiceImpl.getQuesById</center></td>
        <td>语法</td>
        <td>public List List<MessageVO>  getQuesById(int toId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要根据网站运营人员id获取收到的留言列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回收到的留言列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageServiceImpl.getQuesForClientById</center></td>
        <td>语法</td>
        <td>public List<MessageVO> getQuesForClientById(int fromId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要根据客户id获取已发送的留言列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回已发送的留言列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageServiceImpl.getChatById</center></td>
        <td>语法</td>
        <td>public List<MessageVO> getChatById(int toId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要根据留言id获取聊天内容列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回聊天内容列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageServiceImpl.getPrivateAd</center></td>
        <td>语法</td>
        <td>public List<MessageVO> getPrivateAd(int toId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要根据客户id获取收到的推送消息列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回收到的推送消息列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageServiceImpl.getAdSentById</center></td>
        <td>语法</td>
        <td>public List<MessageVO> getAdSentById(int fromId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要网站运营人员id获取发送的推送列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回发送的推送列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageServiceImpl.sendMessage</center></td>
        <td>语法</td>
        <td>public ResponseVO sendMessage(SendMessageVO sendMessageVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要发送消息</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回是否发送成功</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageServiceImpl.changeMessageStatus</center></td>
        <td>语法</td>
        <td>public ResponseVO changeMessageStatus(int id, String status);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要更新消息状态</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回是否更新成功</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>Message.setSendTime(Timestamp sendTime)</td>
        <td colspan="2">设置消息发送时间</td>
    </tr>
    <tr>
        <td>Message.setStatus(String status)</td>
        <td colspan="2">设置消息状态</td>
    </tr>
    <tr>
        <td>Message.setTitle(String title)</td>
        <td colspan="2">设置消息主题</td>
    </tr>
     <tr>
    	<td>Message.setContent(String content)</td>
        <td colspan="2">设置消息内容</td>  
    </tr>
    <tr>
        <td>Message.setFrom(Integer from)</td>
        <td colspan="2">设置消息发送方</td>
    </tr>
    <tr>
        <td>Message.setTo(Integer to)</td>
        <td colspan="2">设置消息接收方</td>
    </tr>
    <tr>
        <td>Message.setType(MessageType type)</td>
        <td colspan="2">设置消息类型</td>
    </tr>
    <tr>
        <td>Message.setRetMsgId(Integer retMsgId)</td>
        <td colspan="2">设置消息所属留言编号</td>
    </tr>
    <tr>
        <td>MessageMapper.getQuesById(int toId)</td>
        <td colspan="2">获取收到的留言列表</td>
    </tr>
    <tr>
    	<td>MessageMapper.getQuesForClientById(int fromId)</td>
        <td colspan="2">获取发送的留言列表</td>
    </tr>
    <tr>
    	<td>MessageMapper.getChatById(int id)</td>
        <td colspan="2">获取留言对应聊天记录</td>
    </tr>
    <tr>
    	<td>MessageMapper.getPrivateAdById(int toId)</td>
        <td colspan="2">获取收到的推送列表</td>
    </tr>
    <tr>
        <td>MessageMapper.getAdSentById(int fromId)</td>
        <td colspan="2">返回发送的推送列表</td>
    </tr>
    <tr>
        <td>MessageMapper.insertMessage(Message message)</td>
        <td colspan="2">添加消息记录</td>
    </tr>
    <tr>
        <td>MessageMapper.changeMessageStatus(int id, String status)</td>
        <td colspan="2">更新消息状态</td>
    </tr>
</table>


###### 4.1.7.3.3 BroadcastImpl

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>BroadcastServiceImpl.getBroadcastList</center></td>
        <td>语法</td>
        <td>public List<BroadcastVO> getBroadcastList();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取网站公告列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回网站公告列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>BroadcastServiceImpl.changeBroadcastStatus</center></td>
        <td>语法</td>
        <td>public ResponseVO changeBroadcastStatus(int id, String status);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要更新网站公告状态</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回是否更新成功</td>
    </tr>
    <tr>
        <td rowspan="3"><center>BroadcastServiceImpl.updatePriority</center></td>
        <td>语法</td>
        <td>public ResponseVO updatePriority(int id, int priority);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要更新网站公告优先级</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回是否更新成功</td>
    </tr>
    <tr>
        <td rowspan="3"><center>BroadcastServiceImpl.sendBroadcast</center></td>
        <td>语法</td>
        <td>public ResponseVO sendBroadcast(SendBroadcastVO sendBroadcastVO)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加网站公告</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回是否添加成功</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>Broadcast.setSendTime(Timestamp sendTime)</td>
        <td colspan="2">设置网站公告添加时间</td>
    </tr>
    <tr>
        <td>Broadcast.setCreatedId(Integer createdId)</td>
        <td colspan="2">设置网站公告状态</td>
    </tr>
    <tr>
        <td>Broadcast.setTitle(String title)</td>
        <td colspan="2">设置网站公告主题</td>
    </tr>
     <tr>
    	<td>Broadcast.setContent(String content)</td>
        <td colspan="2">设置网站公告内容</td>  
    </tr>
    <tr>
        <td>Broadcast.setPriority(Integer priority)</td>
        <td colspan="2">设置网站公告优先级</td>
    </tr>
    <tr>
        <td>Broadcast.setStatus(String status)</td>
        <td colspan="2">设置网站公告状态</td>
    </tr>
    <tr>
        <td>BroadcastMapper.getBroadcastList</td>
        <td colspan="2">获取网站公告列表</td>
    </tr>
    <tr>
    	<td>BroadcastMapper.changeBroadcastStatus(int id, String status)</td>
        <td colspan="2">更新网站公告状态</td>
    </tr>
    <tr>
    	<td>BroadcastMapper.updatePriority(int id, int priority)</td>
        <td colspan="2">更新网站公告优先级</td>
    </tr>
    <tr>
    	<td>BroadcastMapper.insertBroadcast(Broadcast broadcast)</td>
        <td colspan="2">添加网站公告</td>
    </tr>
</table>


###### 4.1.7.3.4 MessageMapper

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageMapper.getQuesById</center></td>
        <td>语法</td>
        <td>public List<Message> getQuesById(int toId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取收到的留言列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回收到的留言列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageMapper.getQuesForClientById</center></td>
        <td>语法</td>
        <td>public List<Message> getQuesForClientById(int fromId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取发送的留言列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回发送的留言列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageMapper.getChatById</center></td>
        <td>语法</td>
        <td>public List<Message> getChatById(int id)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取聊天记录</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回聊天记录</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageMapper.getPrivateAdById</center></td>
        <td>语法</td>
        <td>public List<Message> getPrivateAdById(int toId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取收到的推送列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回收到的推送列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageMapper.getAdSentById</center></td>
        <td>语法</td>
        <td>public List<Message> getAdSentById(int fromId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取发送的推送列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回发送的推送列表/td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageMapper.insertMessage</center></td>
        <td>语法</td>
        <td>public Integer insertMessage(Message message)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加消息记录</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回添加是否成功</td>
    </tr>
    <tr>
        <td rowspan="3"><center>MessageMapper.changeMessageStatus</center></td>
        <td>语法</td>
        <td>public void changeMessageStatus(int id, String status)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要更新消息状态</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回更新是否成功</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>Message.setSendTime(Timestamp sendTime)</td>
        <td colspan="2">设置消息发送时间</td>
    </tr>
    <tr>
        <td>Message.setStatus(String status)</td>
        <td colspan="2">设置消息状态</td>
    </tr>
    <tr>
        <td>Message.setTitle(String title)</td>
        <td colspan="2">设置消息主题</td>
    </tr>
     <tr>
    	<td>Message.setContent(String content)</td>
        <td colspan="2">设置消息内容</td>  
    </tr>
    <tr>
        <td>Message.setFrom(Integer from)</td>
        <td colspan="2">设置消息发送方</td>
    </tr>
    <tr>
        <td>Message.setTo(Integer to)</td>
        <td colspan="2">设置消息接收方</td>
    </tr>
    <tr>
        <td>Message.setType(MessageType type)</td>
        <td colspan="2">设置消息类型</td>
    </tr>
    <tr>
        <td>Message.setRetMsgId(Integer retMsgId)</td>
        <td colspan="2">设置消息所属留言编号</td>
    </tr>
</table>


###### 4.1.7.3.5 BroadcastMapper

<table>
    <tr>
        <td colspan="3"><center>提供的服务（供接口）</center></td>
    </tr>
    <tr>
        <td rowspan="3"><center>BroadcastMapper.getBroadcastList</center></td>
        <td>语法</td>
        <td>public List<Broadcast> getBroadcastList()</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要获取网站公告列表</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回网站公告列表</td>
    </tr>
    <tr>
        <td rowspan="3"><center>BroadcastMapper.changeBroadcastStatus</center></td>
        <td>语法</td>
        <td>public void changeBroadcastStatus(int id, String status)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要更新网站公告状态</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回更新是否成功</td>
    </tr>
    <tr>
        <td rowspan="3"><center>BroadcastMapper.updatePriority</center></td>
        <td>语法</td>
        <td>public void updatePriority(int id, int priority)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要更新网站公告优先级</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回更新是否成功</td>
    </tr>
    <tr>
        <td rowspan="3"><center>BroadcastMapper.insertBroadcast</center></td>
        <td>语法</td>
        <td>public Integer insertBroadcast(Broadcast broadcast)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>需要添加网站公告</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回添加是否成功</td>
    </tr>
    <tr>
        <td colspan="3"><center>需要的服务（需接口）</center></td>
    </tr>
    <tr>
        <td><center>服务名</center></td>
        <td colspan="2"><center>服务</center></td>
    </tr>
    <tr>
        <td>Broadcast.setSendTime(Timestamp sendTime)</td>
        <td colspan="2">设置网站公告添加时间</td>
    </tr>
    <tr>
        <td>Broadcast.setCreatedId(Integer createdId)</td>
        <td colspan="2">设置网站公告状态</td>
    </tr>
    <tr>
        <td>Broadcast.setTitle(String title)</td>
        <td colspan="2">设置网站公告主题</td>
    </tr>
     <tr>
    	<td>Broadcast.setContent(String content)</td>
        <td colspan="2">设置网站公告内容</td>  
    </tr>
    <tr>
        <td>Broadcast.setPriority(Integer priority)</td>
        <td colspan="2">设置网站公告优先级</td>
    </tr>
    <tr>
        <td>Broadcast.setStatus(String status)</td>
        <td colspan="2">设置网站公告状态</td>
    </tr>
</table>


##### 4.1.7.4 业务逻辑层的动态模型

下图表明了客户与网站运营人员留言对话时，业务逻辑处理相关对象之间的协作。

![](https://supernatural.oss-cn-beijing.aliyuncs.com/留言【顺序图】.jpg)

##### 4.1.7.5 业务逻辑层的设计原理

利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的领域对象。



## 5 依赖视角

![](https://ydl8023.oss-cn-beijing.aliyuncs.com/包图.png)

